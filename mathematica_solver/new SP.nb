(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    220869,       5572]
NotebookOptionsPosition[    219523,       5522]
NotebookOutlinePosition[    219866,       5537]
CellTagsIndexPosition[    219823,       5534]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Two-stage SP:", "Section",
 CellChangeTimes->{{3.605825536157975*^9, 3.605825545541512*^9}, {
  3.607684775318982*^9, 3.6076847762237835`*^9}},
 FontSize->14],

Cell[BoxData[{
 RowBox[{
  RowBox[{"<<", "Calendar`"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Definition", " ", "of", " ", "functions", " ", "to", " ", "work", " ", 
    "on", " ", "simulation", " ", 
    RowBox[{"part", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wData", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<wt_data.csv\>\"", ",", "\"\<CSV\>\"", ",", 
     RowBox[{"Path", "\[Rule]", 
      RowBox[{"NotebookDirectory", "[", "]"}]}], ",", 
     RowBox[{"\"\<HeaderLines\>\"", "\[Rule]", "1"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solarRadi", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<solar.txt\>\"", ",", "\"\<Table\>\"", ",", 
     RowBox[{"Path", "\[Rule]", " ", 
      RowBox[{"NotebookDirectory", "[", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"markovChainMatrix", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.7", ",", "0.2", ",", "0.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.6", ",", "0.3", ",", "0.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.5", ",", "0.4", ",", "0.1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stateProb", " ", "=", " ", 
   RowBox[{
    RowBox[{"markovChainMatrix", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ".", 
    RowBox[{"MatrixPower", "[", 
     RowBox[{"markovChainMatrix", ",", "10"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"randomStateSequence", " ", "=", " ", 
    RowBox[{"RandomChoice", "[", 
     RowBox[{
      RowBox[{"stateProb", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<N\>\"", ",", "\"\<A\>\"", ",", "\"\<M\>\""}], "}"}]}], 
      ",", 
      RowBox[{
       RowBox[{"Dimensions", "[", "wData", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Extract", " ", "wind", " ", "and", " ", "time", " ", "data"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"windSpeed", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"wData", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "20"}], "]"}], "]"}], "/", "10"}], "*", 
    "0.44704"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coolingDegreeHours", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"wData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "/.", 
      RowBox[{
       RowBox[{"-", "7777"}], "\[Rule]", "0"}]}], ")"}], "/", "10"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"heatDegreeHours", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"wData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}], "/.", 
      RowBox[{
       RowBox[{"-", "7777"}], "\[Rule]", "0"}]}], ")"}], "/", "10"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cloudOvercastPercentage", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"wData", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "10"}], "]"}], "]"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"-", "7777"}], "\[Rule]", "0"}]}], ")"}], "/", "10"}], "/", 
    "100"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"year", "[", "t_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DateString", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"wData", "[", 
          RowBox[{"[", 
           RowBox[{"t", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Year\>\"", ",", "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", 
           "\"\< \>\"", ",", "\"\<Hour\>\"", ",", "\"\<:\>\"", ",", 
           "\"\<Minute\>\""}], "}"}]}], "}"}], ",", "\"\<Year\>\""}], "]"}], "//",
      "ToExpression"}], "\[IndentingNewLine]", ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"month", "[", "t_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DateString", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"wData", "[", 
          RowBox[{"[", 
           RowBox[{"t", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Year\>\"", ",", "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", 
           "\"\< \>\"", ",", "\"\<Hour\>\"", ",", "\"\<:\>\"", ",", 
           "\"\<Minute\>\""}], "}"}]}], "}"}], ",", "\"\<Month\>\""}], "]"}], 
     "//", "ToExpression"}], "\[IndentingNewLine]", ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"day", "[", "t_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DateString", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"wData", "[", 
          RowBox[{"[", 
           RowBox[{"t", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Year\>\"", ",", "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", 
           "\"\< \>\"", ",", "\"\<Hour\>\"", ",", "\"\<:\>\"", ",", 
           "\"\<Minute\>\""}], "}"}]}], "}"}], ",", "\"\<Day\>\""}], "]"}], "//",
      "ToExpression"}], "\[IndentingNewLine]", ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dayOfWeek", "[", "t_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"DayOfWeek", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"year", "[", "t", "]"}], ",", 
        RowBox[{"month", "[", "t", "]"}], ",", 
        RowBox[{"day", "[", "t", "]"}]}], "}"}], "]"}], "\[IndentingNewLine]",
      ")"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Define", " ", "Price", " ", "of", " ", "buying", " ", "and", " ", 
    RowBox[{"selling", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BuyPrice", "[", "t_", "]"}], ":=", " ", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Saturday", ",", "Sunday"}], "}"}], ",", 
        RowBox[{"dayOfWeek", "[", "t", "]"}]}], "]"}], ",", "0.051", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"7", "\[LessEqual]", " ", 
          RowBox[{"Mod", "[", 
           RowBox[{"t", ",", "24"}], "]"}], "<", "11"}], "||", 
         RowBox[{"17", "<", 
          RowBox[{"Mod", "[", 
           RowBox[{"t", ",", "24"}], "]"}], "\[LessEqual]", " ", "21"}]}], 
        ",", "0.099", ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"11", "\[LessEqual]", 
           RowBox[{"Mod", "[", 
            RowBox[{"t", ",", "24"}], "]"}], "\[LessEqual]", " ", "17"}], ",",
           "0.081", ",", "\[IndentingNewLine]", "0.051"}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SellPrice", "[", "t_", "]"}], ":=", " ", 
    RowBox[{"0.8", "*", 
     RowBox[{"BuyPrice", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Initialize", " ", "stages"}], ",", " ", 
    RowBox[{"currently", " ", "two", " ", 
     RowBox[{"stages", "."}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stageSize", " ", "=", " ", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"availableResources", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", "stageSize"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"demand", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "stageSize"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Initial", " ", "values", " ", "to", " ", 
    RowBox[{"parameters", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"airDensity", " ", "=", " ", "1.27"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"windTurbineCoefficientFactor", " ", "=", " ", "0.5"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"windTurbineRadius", " ", "=", " ", "5"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solarRadiationFactor", " ", "=", " ", "1.2"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solarPanelSize", " ", "=", " ", "100"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initBatt", " ", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", "=", "15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"capBat", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Function", " ", "of", " ", "Available", " ", "Resources", " ", "at", " ", 
    "time", " ", 
    RowBox[{"t", ":", " ", 
     RowBox[{
     "electricity", " ", "power", " ", "from", " ", "wind", " ", "energy", 
      " ", "and", " ", "solar", " ", "energy"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AvailableResource", "[", "t_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"0.5", "*", "windTurbineCoefficientFactor", "*", 
       RowBox[{"windTurbineRadius", "^", "2"}], "*", "airDensity", "*", "Pi", 
       "*", 
       RowBox[{
        RowBox[{"windSpeed", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "^", "3"}]}], "+", 
      RowBox[{"solarRadiationFactor", "*", "solarPanelSize", "*", 
       RowBox[{"solarRadi", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"t", ",", "24"}], "]"}], "+", "1"}], ",", 
          RowBox[{"month", "[", "t", "]"}]}], "]"}], "]"}], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"cloudOvercastPercentage", "[", 
          RowBox[{"[", "t", "]"}], "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
     ")"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Function", " ", "of", " ", "Local", " ", "Demand", " ", "at", " ", "time",
     " ", 
    RowBox[{"t", ":", " ", 
     RowBox[{
     "pick", " ", "a", " ", "random", " ", "integer", " ", "from", " ", 
      "1000", " ", "to", " ", "10000"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Demand", "[", "t_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"t", "\[Equal]", "18"}], ",", "100000", ",", 
        RowBox[{
         RowBox[{"AvailableResource", "[", "t", "]"}], "+", "1000"}]}], "]"}],
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pLossRate", " ", "=", " ", "1000"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"heatDegreeHours", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "*", "pLossRate"}], "+", 
       RowBox[{
        RowBox[{"coolingDegreeHours", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "*", "pLossRate"}], "+", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"500", ",", "5000"}], "}"}], "]"}]}]}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{"1000", ",", "10000"}], "}"}], "]"}], "*)"}], 
     "\[IndentingNewLine]", ")"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Function", " ", "of", " ", "unit", " ", "cost", " ", "of", " ", 
    "reserving", " ", "electricity", " ", "in", " ", 
    RowBox[{"battery", " ", ":", " ", 
     RowBox[{"set", " ", "it", " ", "constant"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReserveCost", "[", "t_", "]"}], ":=", 
    RowBox[{"(", "0.02", ")"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Function", " ", "of", " ", "unit", " ", "cost", " ", "of", " ", 
    "transiting", " ", "electricity", " ", "to", " ", "or", " ", "from", " ", 
    RowBox[{"battery", " ", ":", " ", 
     RowBox[{"set", " ", "it", " ", "constant"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TransitionCost", "[", "t_", "]"}], ":=", 
    RowBox[{"(", "0.01", ")"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Function", " ", "of", " ", "optimization", " ", "of", " ", "simple", " ",
      "two"}], "-", "stage"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"B", "\[Rule]", 
     RowBox[{"C", ":", "1"}]}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"B", "\[Rule]", 
     RowBox[{"G", ":", "2"}]}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"G", "\[Rule]", 
     RowBox[{"B", ":", "3"}]}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"G", "\[Rule]", 
     RowBox[{"C", ":", "4"}]}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"R", "\[Rule]", 
     RowBox[{"B", ":", "5"}]}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"R", "\[Rule]", 
     RowBox[{"C", ":", "6"}]}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"R", "\[Rule]", 
     RowBox[{"G", ":", "7"}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StageMinimize", "[", 
    RowBox[{"t_", ",", "initBatt_"}], "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{"Minimize", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x", "[", "3", "]"}], "+", 
            RowBox[{"x", "[", "4", "]"}]}], ")"}], "*", 
          RowBox[{"BuyPrice", "[", "t", "]"}]}], "+", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"initBatt", "+", 
            RowBox[{"x", "[", "3", "]"}], "+", 
            RowBox[{"x", "[", "5", "]"}], "-", 
            RowBox[{"x", "[", "1", "]"}], "-", 
            RowBox[{"x", "[", "2", "]"}]}], ")"}], "*", 
          RowBox[{"ReserveCost", "[", "t", "]"}]}], " ", "+", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"initBatt", "+", 
            RowBox[{"x", "[", "3", "]"}], "+", 
            RowBox[{"x", "[", "5", "]"}], "+", 
            RowBox[{"x", "[", "1", "]"}], "+", 
            RowBox[{"x", "[", "2", "]"}]}], ")"}], "*", 
          RowBox[{"TransitionCost", "[", "t", "]"}]}], "-", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x", "[", "2", "]"}], "+", 
            RowBox[{"x", "[", "7", "]"}]}], ")"}], "*", 
          RowBox[{"SellPrice", "[", "t", "]"}]}], "+", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"randomStateSequence", "[", 
              RowBox[{"[", "t", "]"}], "]"}], "\[Equal]", "\"\<N\>\""}], ",", 
            RowBox[{"markovChainMatrix", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"randomStateSequence", "[", 
                RowBox[{"[", "t", "]"}], "]"}], "\[Equal]", "\"\<A\>\""}], 
              ",", 
              RowBox[{"markovChainMatrix", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"markovChainMatrix", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}]}], "]"}], "*", 
          RowBox[{"(", "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"4", ",", "1"}], "]"}]}], ")"}], "*", 
             RowBox[{"BuyPrice", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "1"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "1"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "1"}], "]"}]}], ")"}], "*", 
             RowBox[{"ReserveCost", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "1"}], "]"}]}], ")"}], "*", 
             RowBox[{"TransitionCost", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "-", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"7", ",", "1"}], "]"}]}], ")"}], "*", 
             RowBox[{"SellPrice", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}]}], ")"}]}], "+", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"randomStateSequence", "[", 
              RowBox[{"[", "t", "]"}], "]"}], "\[Equal]", "\"\<N\>\""}], ",", 
            RowBox[{"markovChainMatrix", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"randomStateSequence", "[", 
                RowBox[{"[", "t", "]"}], "]"}], "\[Equal]", "\"\<A\>\""}], 
              ",", 
              RowBox[{"markovChainMatrix", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"markovChainMatrix", "[", 
               RowBox[{"3", ",", "2"}], "]"}]}], "]"}]}], "]"}], "*", 
          RowBox[{"(", "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"4", ",", "2"}], "]"}]}], ")"}], "*", 
             RowBox[{"BuyPrice", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "2"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "2"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "2"}], "]"}]}], ")"}], "*", 
             RowBox[{"ReserveCost", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "  ", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "2"}], "]"}]}], ")"}], "*", 
             RowBox[{"TransitionCost", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "-", "\[IndentingNewLine]", 
            "\t\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"7", ",", "2"}], "]"}]}], ")"}], "*", 
             RowBox[{"SellPrice", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}]}], ")"}]}], "+", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"randomStateSequence", "[", 
              RowBox[{"[", "t", "]"}], "]"}], "\[Equal]", "\"\<N\>\""}], ",", 
            RowBox[{"markovChainMatrix", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"randomStateSequence", "[", 
                RowBox[{"[", "t", "]"}], "]"}], "\[Equal]", "\"\<A\>\""}], 
              ",", 
              RowBox[{"markovChainMatrix", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "3"}], "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"markovChainMatrix", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "]"}]}], "]"}], "*", 
          RowBox[{"(", "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"4", ",", "3"}], "]"}]}], ")"}], "*", 
             RowBox[{"BuyPrice", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "3"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "3"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "3"}], "]"}]}], ")"}], "*", 
             RowBox[{"ReserveCost", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "3"}], "]"}]}], ")"}], "*", 
             RowBox[{"TransitionCost", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "-", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"7", ",", "3"}], "]"}]}], ")"}], "*", 
             RowBox[{"SellPrice", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}]}], ")"}]}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "1", "]"}], "+", 
           RowBox[{"x", "[", "4", "]"}], "+", 
           RowBox[{"x", "[", "6", "]"}]}], "\[Equal]", 
          RowBox[{"Demand", "[", "t", "]"}]}], "&&", "\[IndentingNewLine]", 
         RowBox[{"0", "\[LessEqual]", " ", 
          RowBox[{"initBatt", "+", 
           RowBox[{"x", "[", "5", "]"}], "+", 
           RowBox[{"x", "[", "3", "]"}], "-", 
           RowBox[{"x", "[", "2", "]"}], "-", 
           RowBox[{"x", "[", "1", "]"}]}], "\[LessEqual]", " ", "capBat"}], "&&",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "7", "]"}], "+", 
           RowBox[{"x", "[", "5", "]"}], "+", 
           RowBox[{"x", "[", "6", "]"}]}], "\[Equal]", 
          RowBox[{"AvailableResource", "[", "t", "]"}]}], "&&", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"x", "[", "3", "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"x", "[", "4", "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"x", "[", "5", "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"x", "[", "6", "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"x", "[", "7", "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"x", "[", "1", "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"x", "[", "2", "]"}], "\[GreaterEqual]", "0"}], "&&", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"1", ",", "1"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"4", ",", "1"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"6", ",", "1"}], "]"}]}], "\[Equal]", 
          RowBox[{"Demand", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "&&", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"initBatt", "+", 
             RowBox[{"x", "[", "3", "]"}], "+", 
             RowBox[{"x", "[", "5", "]"}], "-", 
             RowBox[{"x", "[", "1", "]"}], "-", 
             RowBox[{"x", "[", "2", "]"}]}], ")"}]}], "\[LessEqual]", " ", 
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"5", ",", "1"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"3", ",", "1"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"2", ",", "1"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"1", ",", "1"}], "]"}]}], "\[LessEqual]", " ", 
          RowBox[{"capBat", "-", 
           RowBox[{"(", 
            RowBox[{"initBatt", "+", 
             RowBox[{"x", "[", "3", "]"}], "+", 
             RowBox[{"x", "[", "5", "]"}], "-", 
             RowBox[{"x", "[", "1", "]"}], "-", 
             RowBox[{"x", "[", "2", "]"}]}], ")"}]}]}], "&&", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"7", ",", "1"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"5", ",", "1"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"6", ",", "1"}], "]"}]}], "\[Equal]", 
          RowBox[{"AvailableResource", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "&&", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"3", ",", "1"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"4", ",", "1"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"5", ",", "1"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"6", ",", "1"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"7", ",", "1"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"1", ",", "1"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"2", ",", "1"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"1", ",", "2"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"4", ",", "2"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"6", ",", "2"}], "]"}]}], "\[Equal]", 
          RowBox[{"Demand", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "&&", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"initBatt", "+", 
             RowBox[{"x", "[", "3", "]"}], "+", 
             RowBox[{"x", "[", "5", "]"}], "-", 
             RowBox[{"x", "[", "1", "]"}], "-", 
             RowBox[{"x", "[", "2", "]"}]}], ")"}]}], "\[LessEqual]", " ", 
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"5", ",", "2"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"3", ",", "2"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"2", ",", "2"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"1", ",", "2"}], "]"}]}], "\[LessEqual]", " ", 
          RowBox[{"capBat", "-", 
           RowBox[{"(", 
            RowBox[{"initBatt", "+", 
             RowBox[{"x", "[", "3", "]"}], "+", 
             RowBox[{"x", "[", "5", "]"}], "-", 
             RowBox[{"x", "[", "1", "]"}], "-", 
             RowBox[{"x", "[", "2", "]"}]}], ")"}]}]}], "&&", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"7", ",", "2"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"5", ",", "2"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"6", ",", "2"}], "]"}]}], "\[Equal]", 
          RowBox[{
           RowBox[{"AvailableResource", "[", 
            RowBox[{"t", "+", "1"}], "]"}], "/", "2"}]}], "&&", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"3", ",", "2"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"4", ",", "2"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"5", ",", "2"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"6", ",", "2"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"7", ",", "2"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"1", ",", "2"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"2", ",", "2"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"1", ",", "3"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"4", ",", "3"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"6", ",", "3"}], "]"}]}], "\[Equal]", 
          RowBox[{"Demand", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "&&", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"initBatt", "+", 
             RowBox[{"x", "[", "3", "]"}], "+", 
             RowBox[{"x", "[", "5", "]"}], "-", 
             RowBox[{"x", "[", "1", "]"}], "-", 
             RowBox[{"x", "[", "2", "]"}]}], ")"}]}], "\[LessEqual]", " ", 
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"5", ",", "3"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"3", ",", "3"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"2", ",", "3"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"1", ",", "3"}], "]"}]}], "\[LessEqual]", " ", 
          RowBox[{"capBat", "-", 
           RowBox[{"(", 
            RowBox[{"initBatt", "+", 
             RowBox[{"x", "[", "3", "]"}], "+", 
             RowBox[{"x", "[", "5", "]"}], "-", 
             RowBox[{"x", "[", "1", "]"}], "-", 
             RowBox[{"x", "[", "2", "]"}]}], ")"}]}]}], "&&", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"7", ",", "3"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"5", ",", "3"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"6", ",", "3"}], "]"}]}], "\[Equal]", 
          RowBox[{
           RowBox[{"AvailableResource", "[", 
            RowBox[{"t", "+", "1"}], "]"}], "/", "4"}]}], "&&", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"3", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"4", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"5", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"6", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"7", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"1", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"2", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}]}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", "[", "3", "]"}], ",", 
        RowBox[{"x", "[", "4", "]"}], ",", 
        RowBox[{"x", "[", "5", "]"}], ",", 
        RowBox[{"x", "[", "6", "]"}], ",", 
        RowBox[{"x", "[", "7", "]"}], ",", 
        RowBox[{"x", "[", "1", "]"}], ",", 
        RowBox[{"x", "[", "2", "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"3", ",", "1"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"4", ",", "1"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"5", ",", "1"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"6", ",", "1"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"7", ",", "1"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"1", ",", "1"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"2", ",", "1"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"3", ",", "2"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"4", ",", "2"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"5", ",", "2"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"6", ",", "2"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"7", ",", "2"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"2", ",", "2"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"3", ",", "3"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"4", ",", "3"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"5", ",", "3"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"6", ",", "3"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"7", ",", "3"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"1", ",", "3"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"2", ",", "3"}], "]"}]}], "}"}]}], "]"}], 
    "\[IndentingNewLine]", ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6040903810218115`*^9, 3.6040904250083275`*^9}, {
   3.604090582596341*^9, 3.6040905915768547`*^9}, {3.6040914535951595`*^9, 
   3.604091493605448*^9}, {3.6040990387680063`*^9, 3.6040990392930365`*^9}, {
   3.604100627103854*^9, 3.604100659143687*^9}, {3.604100801623836*^9, 
   3.6041008984763756`*^9}, {3.604152105195197*^9, 3.604152172374039*^9}, {
   3.604152293968994*^9, 3.6041523151892076`*^9}, {3.6041524666478705`*^9, 
   3.604152474539322*^9}, {3.604152505030066*^9, 3.6041526103540897`*^9}, {
   3.6041527249666457`*^9, 3.604152831673749*^9}, {3.6041530261438723`*^9, 
   3.6041530314631763`*^9}, {3.6041532547839494`*^9, 
   3.6041533001495442`*^9}, {3.6041535995236673`*^9, 3.604153634593673*^9}, {
   3.6041536759470387`*^9, 3.6041536793922358`*^9}, {3.604153745209*^9, 
   3.604153769563393*^9}, {3.604154206191367*^9, 3.6041542797575746`*^9}, {
   3.604154526303676*^9, 3.6041545668229938`*^9}, {3.6041547856575108`*^9, 
   3.6041548406926584`*^9}, {3.604154921275267*^9, 3.604154977363475*^9}, {
   3.604155062846365*^9, 3.6041550648684807`*^9}, {3.6041563074305506`*^9, 
   3.604156313569902*^9}, {3.604156430222574*^9, 3.6041564440073624`*^9}, {
   3.60415649414123*^9, 3.6041566613137918`*^9}, {3.60415691373623*^9, 
   3.6041569274220123`*^9}, {3.6041569740206776`*^9, 
   3.6041570257486362`*^9}, {3.604166516543479*^9, 3.6041665629461327`*^9}, {
   3.604188032569934*^9, 3.6041880329199543`*^9}, {3.604188175560113*^9, 
   3.604188282310219*^9}, {3.604188618486447*^9, 3.6041886250968246`*^9}, {
   3.604190037784626*^9, 3.6041901868911543`*^9}, {3.6041907511224265`*^9, 
   3.6041908532212667`*^9}, {3.6041908962457275`*^9, 
   3.6041909152288127`*^9}, {3.604191412898278*^9, 3.604191421605776*^9}, {
   3.6041936026585255`*^9, 3.6041936031385527`*^9}, {3.604194398895067*^9, 
   3.604194401656225*^9}, {3.604195092825758*^9, 3.60419517609052*^9}, {
   3.604195432886208*^9, 3.6041954330892196`*^9}, {3.604196248661868*^9, 
   3.604196268352994*^9}, {3.6041964588828917`*^9, 3.604196462682109*^9}, {
   3.6041975942918334`*^9, 3.6041976054334707`*^9}, {3.6041977455394845`*^9, 
   3.604197747051571*^9}, 3.6041990769576373`*^9, {3.60419944940594*^9, 
   3.6041994746013813`*^9}, {3.6041996267350826`*^9, 
   3.6041996269100924`*^9}, {3.604237302418082*^9, 3.6042373047782173`*^9}, {
   3.6042374300473824`*^9, 3.604237641078452*^9}, {3.6042378870965242`*^9, 
   3.604237944230792*^9}, {3.604238039946266*^9, 3.6042381127004275`*^9}, {
   3.60423816012114*^9, 3.604238160315151*^9}, {3.6042384029980316`*^9, 
   3.6042384042411027`*^9}, {3.604238509742137*^9, 3.604238658166627*^9}, {
   3.6042868420218744`*^9, 3.604287029877404*^9}, {3.6042871900962057`*^9, 
   3.604287192851363*^9}, {3.6042873421839046`*^9, 3.604287389719623*^9}, {
   3.604287532368782*^9, 3.6042875345249057`*^9}, {3.604287901110873*^9, 
   3.604287908551299*^9}, {3.6043233093001766`*^9, 3.6043233108841767`*^9}, {
   3.604323352283177*^9, 3.6043233530501766`*^9}, {3.6043235434981766`*^9, 
   3.604323556217177*^9}, 3.6043246208581767`*^9, 3.604324762329177*^9, {
   3.604324826065177*^9, 3.604324978653177*^9}, {3.604325038673177*^9, 
   3.604325065040177*^9}, {3.6043251776891766`*^9, 3.6043251789101768`*^9}, {
   3.6043253807931767`*^9, 3.6043253950351768`*^9}, {3.604325897969177*^9, 
   3.604325898311177*^9}, {3.6043261456041765`*^9, 3.604326147988177*^9}, {
   3.6043262975641766`*^9, 3.6043262981231766`*^9}, {3.6057458462809153`*^9, 
   3.605745885128137*^9}, {3.6057459373381233`*^9, 3.6057461275110006`*^9}, {
   3.605746222279421*^9, 3.605746231545951*^9}, {3.605751035184704*^9, 
   3.6057510644173756`*^9}, {3.6057511108440313`*^9, 
   3.6057511952228575`*^9}, {3.60575124789287*^9, 3.6057512685250497`*^9}, {
   3.605751541656672*^9, 3.605751541781679*^9}, {3.605751692392294*^9, 
   3.6057517607802052`*^9}, {3.6057524638794203`*^9, 3.605752465784529*^9}, {
   3.605752520585664*^9, 3.605752526701013*^9}, {3.6057525924767756`*^9, 
   3.6057526464858646`*^9}, {3.6057526766965923`*^9, 3.605752692443493*^9}, {
   3.605752744749485*^9, 3.605752806882039*^9}, {3.6057528498308306`*^9, 
   3.6057528684098935`*^9}, {3.605752906188054*^9, 3.6057529255601625`*^9}, 
   3.6058248388560915`*^9, {3.6058966690088763`*^9, 3.6058966764323006`*^9}, {
   3.6088541736873555`*^9, 3.6088541739993734`*^9}},
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"firstStage", " ", "=", " ", 
  RowBox[{"StageMinimize", "[", 
   RowBox[{"t", ",", "initBatt"}], "]"}]}]], "Input",
 FontSize->14],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4872.056270925699`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "[", "3", "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"x", "[", "4", "]"}], "\[Rule]", "28097.392050909515`"}], ",", 
     RowBox[{
      RowBox[{"x", "[", "5", "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"x", "[", "6", "]"}], "\[Rule]", "11649.607949090485`"}], ",", 
     RowBox[{
      RowBox[{"x", "[", "7", "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"x", "[", "1", "]"}], "\[Rule]", "100.`"}], ",", 
     RowBox[{
      RowBox[{"x", "[", "2", "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"3", ",", "1"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"4", ",", "1"}], "]"}], "\[Rule]", "30776.072050909515`"}], 
     ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"5", ",", "1"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"6", ",", "1"}], "]"}], "\[Rule]", "4939.927949090484`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"7", ",", "1"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"1", ",", "1"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"3", ",", "2"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"4", ",", "2"}], "]"}], "\[Rule]", "34817.036025454756`"}], 
     ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"5", ",", "2"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"6", ",", "2"}], "]"}], "\[Rule]", "2469.963974545242`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"7", ",", "2"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"2", ",", "2"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"3", ",", "3"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"4", ",", "3"}], "]"}], "\[Rule]", "35201.01801272738`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"5", ",", "3"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"6", ",", "3"}], "]"}], "\[Rule]", "1234.981987272621`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"7", ",", "3"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"1", ",", "3"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"2", ",", "3"}], "]"}], "\[Rule]", "0.`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.605752933246602*^9, {3.60582081691105*^9, 3.6058208221623497`*^9}, {
   3.6058249575308795`*^9, 3.6058249687025185`*^9}, 3.6058253983390923`*^9, 
   3.6058255093344407`*^9},
 FontSize->14]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Three stages SP:", "Section",
 CellChangeTimes->{{3.605825523431247*^9, 3.6058255529019327`*^9}},
 FontSize->14],

Cell[BoxData[{
 RowBox[{
  RowBox[{"<<", "Calendar`"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Definition", " ", "of", " ", "functions", " ", "to", " ", "work", " ", 
    "on", " ", "simulation", " ", 
    RowBox[{"part", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wData", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<wt_data.csv\>\"", ",", "\"\<CSV\>\"", ",", 
     RowBox[{"Path", "\[Rule]", 
      RowBox[{"NotebookDirectory", "[", "]"}]}], ",", 
     RowBox[{"\"\<HeaderLines\>\"", "\[Rule]", "1"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solarRadi", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<solar.txt\>\"", ",", "\"\<Table\>\"", ",", 
     RowBox[{"Path", "\[Rule]", " ", 
      RowBox[{"NotebookDirectory", "[", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"markovChainMatrix", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.7", ",", "0.2", ",", "0.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.6", ",", "0.3", ",", "0.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.5", ",", "0.4", ",", "0.1"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Three", "-", 
    RowBox[{"stage", " ", "probability", " ", "matrix"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"markovChainMatrix", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "All"}], "]"}], "]"}], "]"}], ".", 
     "markovChainMatrix"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t2", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"markovChainMatrix", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "All"}], "]"}], "]"}], "]"}], ".", 
     "markovChainMatrix"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t3", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"markovChainMatrix", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "All"}], "]"}], "]"}], "]"}], ".", 
     "markovChainMatrix"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"threeMatrix", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"t1", ",", "t2", ",", "t3"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stateProb", " ", "=", " ", 
   RowBox[{
    RowBox[{"markovChainMatrix", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ".", 
    RowBox[{"MatrixPower", "[", 
     RowBox[{"markovChainMatrix", ",", "10"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"randomStateSequence", " ", "=", " ", 
    RowBox[{"RandomChoice", "[", 
     RowBox[{
      RowBox[{"stateProb", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<N\>\"", ",", "\"\<A\>\"", ",", "\"\<M\>\""}], "}"}]}], 
      ",", 
      RowBox[{
       RowBox[{"Dimensions", "[", "wData", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Extract", " ", "wind", " ", "and", " ", "time", " ", "data"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"windSpeed", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"wData", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "20"}], "]"}], "]"}], "/", "10"}], "*", 
    "0.44704"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coolingDegreeHours", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"wData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "/.", 
      RowBox[{
       RowBox[{"-", "7777"}], "\[Rule]", "0"}]}], ")"}], "/", "10"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"heatDegreeHours", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"wData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}], "/.", 
      RowBox[{
       RowBox[{"-", "7777"}], "\[Rule]", "0"}]}], ")"}], "/", "10"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cloudOvercastPercentage", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"wData", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "3"}], "]"}], "]"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"-", "7777"}], "\[Rule]", "0"}]}], ")"}], "/", "10"}], "/", 
    "100"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"year", "[", "t_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DateString", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"wData", "[", 
          RowBox[{"[", 
           RowBox[{"t", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Year\>\"", ",", "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", 
           "\"\< \>\"", ",", "\"\<Hour\>\"", ",", "\"\<:\>\"", ",", 
           "\"\<Minute\>\""}], "}"}]}], "}"}], ",", "\"\<Year\>\""}], "]"}], "//",
      "ToExpression"}], "\[IndentingNewLine]", ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"month", "[", "t_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DateString", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"wData", "[", 
          RowBox[{"[", 
           RowBox[{"t", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Year\>\"", ",", "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", 
           "\"\< \>\"", ",", "\"\<Hour\>\"", ",", "\"\<:\>\"", ",", 
           "\"\<Minute\>\""}], "}"}]}], "}"}], ",", "\"\<Month\>\""}], "]"}], 
     "//", "ToExpression"}], "\[IndentingNewLine]", ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"day", "[", "t_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DateString", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"wData", "[", 
          RowBox[{"[", 
           RowBox[{"t", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Year\>\"", ",", "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", 
           "\"\< \>\"", ",", "\"\<Hour\>\"", ",", "\"\<:\>\"", ",", 
           "\"\<Minute\>\""}], "}"}]}], "}"}], ",", "\"\<Day\>\""}], "]"}], "//",
      "ToExpression"}], "\[IndentingNewLine]", ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dayOfWeek", "[", "t_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"DayOfWeek", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"year", "[", "t", "]"}], ",", 
        RowBox[{"month", "[", "t", "]"}], ",", 
        RowBox[{"day", "[", "t", "]"}]}], "}"}], "]"}], "\[IndentingNewLine]",
      ")"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Define", " ", "Price", " ", "of", " ", "buying", " ", "and", " ", 
    RowBox[{"selling", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BuyPrice", "[", "t_", "]"}], ":=", " ", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Saturday", ",", "Sunday"}], "}"}], ",", 
        RowBox[{"dayOfWeek", "[", "t", "]"}]}], "]"}], ",", "0.051", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"7", "\[LessEqual]", " ", 
          RowBox[{"Mod", "[", 
           RowBox[{"t", ",", "24"}], "]"}], "<", "11"}], "||", 
         RowBox[{"17", "<", 
          RowBox[{"Mod", "[", 
           RowBox[{"t", ",", "24"}], "]"}], "\[LessEqual]", " ", "21"}]}], 
        ",", "0.099", ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"11", "\[LessEqual]", 
           RowBox[{"Mod", "[", 
            RowBox[{"t", ",", "24"}], "]"}], "\[LessEqual]", " ", "17"}], ",",
           "0.081", ",", "\[IndentingNewLine]", "0.051"}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SellPrice", "[", "t_", "]"}], ":=", " ", 
    RowBox[{"0.8", "*", 
     RowBox[{"BuyPrice", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Initialize", " ", "stages"}], ",", " ", 
    RowBox[{"currently", " ", "two", " ", 
     RowBox[{"stages", "."}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stageSize", " ", "=", " ", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"availableResources", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", "stageSize"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"demand", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "stageSize"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Initial", " ", "values", " ", "to", " ", 
    RowBox[{"parameters", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"airDensity", " ", "=", " ", "1.27"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"windTurbineCoefficientFactor", " ", "=", " ", "0.5"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"windTurbineRadius", " ", "=", " ", "5"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solarRadiationFactor", " ", "=", " ", "1.2"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solarPanelSize", " ", "=", " ", "100"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initBatt", " ", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", "=", "15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"capBat", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Function", " ", "of", " ", "Available", " ", "Resources", " ", "at", " ", 
    "time", " ", 
    RowBox[{"t", ":", " ", 
     RowBox[{
     "electricity", " ", "power", " ", "from", " ", "wind", " ", "energy", 
      " ", "and", " ", "solar", " ", "energy"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AvailableResource", "[", "t_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"0.5", "*", "windTurbineCoefficientFactor", "*", 
       RowBox[{"windTurbineRadius", "^", "2"}], "*", "airDensity", "*", "Pi", 
       "*", 
       RowBox[{
        RowBox[{"windSpeed", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "^", "3"}]}], "+", 
      RowBox[{"solarRadiationFactor", "*", "solarPanelSize", "*", 
       RowBox[{"solarRadi", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"t", ",", "24"}], "]"}], "+", "1"}], ",", 
          RowBox[{"month", "[", "t", "]"}]}], "]"}], "]"}], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"cloudOvercastPercentage", "[", 
          RowBox[{"[", "t", "]"}], "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
     ")"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Function", " ", "of", " ", "Local", " ", "Demand", " ", "at", " ", "time",
     " ", 
    RowBox[{"t", ":", " ", 
     RowBox[{
     "pick", " ", "a", " ", "random", " ", "integer", " ", "from", " ", 
      "1000", " ", "to", " ", "10000"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Demand", "[", "t_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"t", "\[Equal]", "18"}], ",", "100000", ",", 
        RowBox[{
         RowBox[{"AvailableResource", "[", "t", "]"}], "+", "1000"}]}], "]"}],
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pLossRate", " ", "=", " ", "1000"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"heatDegreeHours", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "*", "pLossRate"}], "+", 
       RowBox[{
        RowBox[{"coolingDegreeHours", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "*", "pLossRate"}], "+", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"500", ",", "5000"}], "}"}], "]"}]}]}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{"1000", ",", "10000"}], "}"}], "]"}], "*)"}], 
     "\[IndentingNewLine]", ")"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Function", " ", "of", " ", "unit", " ", "cost", " ", "of", " ", 
    "reserving", " ", "electricity", " ", "in", " ", 
    RowBox[{"battery", " ", ":", " ", 
     RowBox[{"set", " ", "it", " ", "constant"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReserveCost", "[", "t_", "]"}], ":=", 
    RowBox[{"(", "0.02", ")"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Function", " ", "of", " ", "unit", " ", "cost", " ", "of", " ", 
    "transiting", " ", "electricity", " ", "to", " ", "or", " ", "from", " ", 
    RowBox[{"battery", " ", ":", " ", 
     RowBox[{"set", " ", "it", " ", "constant"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TransitionCost", "[", "t_", "]"}], ":=", 
    RowBox[{"(", "0.01", ")"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Function", " ", "of", " ", "optimization", " ", "of", " ", "simple", " ",
      "two"}], "-", "stage"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"B", "\[Rule]", 
     RowBox[{"C", ":", "1"}]}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"B", "\[Rule]", 
     RowBox[{"G", ":", "2"}]}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"G", "\[Rule]", 
     RowBox[{"B", ":", "3"}]}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"G", "\[Rule]", 
     RowBox[{"C", ":", "4"}]}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"R", "\[Rule]", 
     RowBox[{"B", ":", "5"}]}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"R", "\[Rule]", 
     RowBox[{"C", ":", "6"}]}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"R", "\[Rule]", 
     RowBox[{"G", ":", "7"}]}]}], "\[IndentingNewLine]", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StageMinimize", "[", 
    RowBox[{"t_", ",", "initBatt_"}], "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{"Minimize", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", "[", "2", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"1", ",", "3"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"4", ",", "3"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"6", ",", "3"}], "]"}]}], "\[Equal]", 
          RowBox[{"Demand", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "&&", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"initBatt", "+", 
             RowBox[{"x", "[", "3", "]"}], "+", 
             RowBox[{"x", "[", "5", "]"}], "-", 
             RowBox[{"x", "[", "1", "]"}], "-", 
             RowBox[{"x", "[", "2", "]"}]}], ")"}]}], "\[LessEqual]", " ", 
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"5", ",", "3"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"3", ",", "3"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"2", ",", "3"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"1", ",", "3"}], "]"}]}], "\[LessEqual]", " ", 
          RowBox[{"capBat", "-", 
           RowBox[{"(", 
            RowBox[{"initBatt", "+", 
             RowBox[{"x", "[", "3", "]"}], "+", 
             RowBox[{"x", "[", "5", "]"}], "-", 
             RowBox[{"x", "[", "1", "]"}], "-", 
             RowBox[{"x", "[", "2", "]"}]}], ")"}]}]}], "&&", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"7", ",", "3"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"5", ",", "3"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"6", ",", "3"}], "]"}]}], "\[Equal]", 
          RowBox[{
           RowBox[{"AvailableResource", "[", 
            RowBox[{"t", "+", "1"}], "]"}], "/", "4"}]}], "&&", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"3", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"4", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"5", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"6", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"7", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"1", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"2", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"state", "[", 
           RowBox[{"t", "+", "2"}], "]"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "[", 
            RowBox[{"1", ",", "1"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"4", ",", "1"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"6", ",", "1"}], "]"}]}], "\[Equal]", 
          RowBox[{"Demand", "[", 
           RowBox[{"t", "+", "2"}], "]"}]}], "&&", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"initBatt", "+", 
             RowBox[{"x", "[", "3", "]"}], "+", 
             RowBox[{"x", "[", "5", "]"}], "-", 
             RowBox[{"x", "[", "1", "]"}], "-", 
             RowBox[{"x", "[", "2", "]"}]}], ")"}]}], "\[LessEqual]", " ", 
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"5", ",", "1"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"3", ",", "1"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"2", ",", "1"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"1", ",", "1"}], "]"}]}], "\[LessEqual]", " ", 
          RowBox[{"capBat", "-", 
           RowBox[{"(", 
            RowBox[{"initBatt", "+", 
             RowBox[{"x", "[", "3", "]"}], "+", 
             RowBox[{"x", "[", "5", "]"}], "-", 
             RowBox[{"x", "[", "1", "]"}], "-", 
             RowBox[{"x", "[", "2", "]"}]}], ")"}]}]}], "&&", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"7", ",", "1"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"5", ",", "1"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"6", ",", "1"}], "]"}]}], "\[Equal]", 
          RowBox[{"AvailableResource", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "\[IndentingNewLine]", "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"1", ",", "1"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"1", ",", "2"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"1", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"1", ",", "4"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"1", ",", "5"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"1", ",", "6"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"1", ",", "7"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"1", ",", "8"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"1", ",", "9"}], "]"}], "\[GreaterEqual]", "0"}], 
         "\[IndentingNewLine]", "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"2", ",", "1"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"2", ",", "2"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"2", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"2", ",", "4"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"2", ",", "5"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"2", ",", "6"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"2", ",", "7"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"2", ",", "8"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"2", ",", "9"}], "]"}], "\[GreaterEqual]", "0"}], 
         "\[IndentingNewLine]", "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"3", ",", "1"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"3", ",", "2"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"3", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"3", ",", "4"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"3", ",", "5"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"3", ",", "6"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"3", ",", "7"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"3", ",", "8"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"3", ",", "9"}], "]"}], "\[GreaterEqual]", "0"}], 
         "\[IndentingNewLine]", "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"4", ",", "1"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"4", ",", "2"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"4", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"4", ",", "4"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"4", ",", "5"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"4", ",", "6"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"4", ",", "7"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"4", ",", "8"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"4", ",", "9"}], "]"}], "\[GreaterEqual]", "0"}], 
         "\[IndentingNewLine]", "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"5", ",", "1"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"5", ",", "2"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"5", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"5", ",", "4"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"5", ",", "5"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"5", ",", "6"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"5", ",", "7"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"5", ",", "8"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"5", ",", "9"}], "]"}], "\[GreaterEqual]", "0"}], 
         "\[IndentingNewLine]", "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"6", ",", "1"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"6", ",", "2"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"6", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"6", ",", "4"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"6", ",", "5"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"6", ",", "6"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"6", ",", "7"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"6", ",", "8"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"6", ",", "9"}], "]"}], "\[GreaterEqual]", "0"}], 
         "\[IndentingNewLine]", "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"7", ",", "1"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"7", ",", "2"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"7", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"7", ",", "4"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"7", ",", "5"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"7", ",", "6"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"7", ",", "7"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"7", ",", "8"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"7", ",", "9"}], "]"}], "\[GreaterEqual]", "0"}]}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", "[", "3", "]"}], ",", 
        RowBox[{"x", "[", "4", "]"}], ",", 
        RowBox[{"x", "[", "5", "]"}], ",", 
        RowBox[{"x", "[", "6", "]"}], ",", 
        RowBox[{"x", "[", "7", "]"}], ",", 
        RowBox[{"x", "[", "1", "]"}], ",", 
        RowBox[{"x", "[", "2", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"y", "[", 
         RowBox[{"3", ",", "1"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"4", ",", "1"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"5", ",", "1"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"6", ",", "1"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"7", ",", "1"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"1", ",", "1"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"2", ",", "1"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"3", ",", "2"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"4", ",", "2"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"5", ",", "2"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"6", ",", "2"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"7", ",", "2"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"2", ",", "2"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"3", ",", "3"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"4", ",", "3"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"5", ",", "3"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"6", ",", "3"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"7", ",", "3"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"1", ",", "3"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"2", ",", "3"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"z", "[", 
         RowBox[{"1", ",", "1"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"2", ",", "1"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"3", ",", "1"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"4", ",", "1"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"5", ",", "1"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"6", ",", "1"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"7", ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"z", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"2", ",", "2"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"3", ",", "2"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"4", ",", "2"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"5", ",", "2"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"6", ",", "2"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"7", ",", "2"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"z", "[", 
         RowBox[{"1", ",", "3"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"2", ",", "3"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"3", ",", "3"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"4", ",", "3"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"5", ",", "3"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"6", ",", "3"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"7", ",", "3"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"z", "[", 
         RowBox[{"1", ",", "4"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"2", ",", "4"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"3", ",", "4"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"4", ",", "4"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"5", ",", "4"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"6", ",", "4"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"7", ",", "4"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"z", "[", 
         RowBox[{"1", ",", "5"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"2", ",", "5"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"3", ",", "5"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"4", ",", "5"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"5", ",", "5"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"6", ",", "5"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"7", ",", "5"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"z", "[", 
         RowBox[{"1", ",", "6"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"2", ",", "6"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"3", ",", "6"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"4", ",", "6"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"5", ",", "6"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"6", ",", "6"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"7", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"z", "[", 
         RowBox[{"1", ",", "7"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"2", ",", "7"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"3", ",", "7"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"4", ",", "7"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"5", ",", "7"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"6", ",", "7"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"7", ",", "7"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"z", "[", 
         RowBox[{"1", ",", "8"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"2", ",", "8"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"3", ",", "8"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"4", ",", "8"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"5", ",", "8"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"6", ",", "8"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"7", ",", "8"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"z", "[", 
         RowBox[{"1", ",", "9"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"2", ",", "9"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"3", ",", "9"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"4", ",", "9"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"5", ",", "9"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"6", ",", "9"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"7", ",", "9"}], "]"}]}], "}"}]}], "]"}], 
    "\[IndentingNewLine]", ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.605836587559079*^9, 3.6058367443860493`*^9}, {
   3.605836794787932*^9, 3.605836801242301*^9}, {3.6058388236359754`*^9, 
   3.605838907337763*^9}, {3.605838953701415*^9, 3.6058389827700777`*^9}, {
   3.6058390333779716`*^9, 3.605839129606476*^9}, {3.6058392562687206`*^9, 
   3.605839352604231*^9}, {3.605873501104938*^9, 3.6058735536149416`*^9}, {
   3.60587367230373*^9, 3.605873800488062*^9}, {3.6058740350464773`*^9, 
   3.6058741114808493`*^9}, {3.605874146135832*^9, 3.6058741931135187`*^9}, {
   3.605874850330109*^9, 3.605874885753135*^9}, {3.605875005300973*^9, 
   3.6058751958088694`*^9}, {3.605875379709388*^9, 3.60587539250412*^9}, {
   3.6058756161869135`*^9, 3.605875714453534*^9}, {3.6058757649434223`*^9, 
   3.605875870907483*^9}, {3.605875922304423*^9, 3.6058760108214855`*^9}, {
   3.605876041413235*^9, 3.6058760415052404`*^9}, {3.605876077826318*^9, 
   3.6058762208304977`*^9}, {3.605876598903122*^9, 3.605876619428296*^9}, {
   3.6058818078305883`*^9, 3.6058818569706745`*^9}, 3.605890184597989*^9, {
   3.6058903922788677`*^9, 3.6058904030554843`*^9}, 3.6058915910444336`*^9, {
   3.6058919764474773`*^9, 3.605891978713607*^9}, 3.605895034127366*^9, {
   3.6058967182196913`*^9, 3.6058967530036807`*^9}, {3.605896798904306*^9, 
   3.605896817975397*^9}, {3.6058988558028*^9, 3.6058988559588003`*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{"firstStep", " ", "=", " ", 
  RowBox[{"StageMinimize", "[", 
   RowBox[{"10", ",", "10"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.605875327444399*^9, 3.6058753447463884`*^9}},
 FontSize->14]
}, Open  ]],

Cell[CellGroupData[{

Cell["New Three-stage SP:", "Section",
 CellChangeTimes->{{3.6058850454903097`*^9, 3.605885053573772*^9}},
 FontSize->14],

Cell[BoxData[{
 RowBox[{
  RowBox[{"<<", "Calendar`"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Definition", " ", "of", " ", "functions", " ", "to", " ", "work", " ", 
    "on", " ", "simulation", " ", 
    RowBox[{"part", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wData", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<wt_data.csv\>\"", ",", "\"\<CSV\>\"", ",", 
     RowBox[{"Path", "\[Rule]", 
      RowBox[{"NotebookDirectory", "[", "]"}]}], ",", 
     RowBox[{"\"\<HeaderLines\>\"", "\[Rule]", "1"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solarRadi", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<solar.txt\>\"", ",", "\"\<Table\>\"", ",", 
     RowBox[{"Path", "\[Rule]", " ", 
      RowBox[{"NotebookDirectory", "[", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"markovChainMatrix", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.7", ",", "0.2", ",", "0.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.6", ",", "0.3", ",", "0.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.5", ",", "0.4", ",", "0.1"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Three", "-", 
    RowBox[{"stage", " ", "probability", " ", "matrix"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"markovChainMatrix", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "All"}], "]"}], "]"}], "]"}], ".", 
     "markovChainMatrix"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t2", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"markovChainMatrix", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "All"}], "]"}], "]"}], "]"}], ".", 
     "markovChainMatrix"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t3", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"markovChainMatrix", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "All"}], "]"}], "]"}], "]"}], ".", 
     "markovChainMatrix"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"threeMatrix", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"t1", ",", "t2", ",", "t3"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stateProb", " ", "=", " ", 
   RowBox[{
    RowBox[{"markovChainMatrix", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ".", 
    RowBox[{"MatrixPower", "[", 
     RowBox[{"markovChainMatrix", ",", "10"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"randomStateSequence", " ", "=", " ", 
    RowBox[{"RandomChoice", "[", 
     RowBox[{
      RowBox[{"stateProb", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<N\>\"", ",", "\"\<A\>\"", ",", "\"\<M\>\""}], "}"}]}], 
      ",", 
      RowBox[{
       RowBox[{"Dimensions", "[", "wData", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Extract", " ", "wind", " ", "and", " ", "time", " ", "data"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"windSpeed", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"wData", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "20"}], "]"}], "]"}], "/", "10"}], "*", 
    "0.44704"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coolingDegreeHours", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"wData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "/.", 
      RowBox[{
       RowBox[{"-", "7777"}], "\[Rule]", "0"}]}], ")"}], "/", "10"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"heatDegreeHours", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"wData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}], "/.", 
      RowBox[{
       RowBox[{"-", "7777"}], "\[Rule]", "0"}]}], ")"}], "/", "10"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cloudOvercastPercentage", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"wData", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "3"}], "]"}], "]"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"-", "7777"}], "\[Rule]", "0"}]}], ")"}], "/", "10"}], "/", 
    "100"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"year", "[", "t_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DateString", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"wData", "[", 
          RowBox[{"[", 
           RowBox[{"t", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Year\>\"", ",", "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", 
           "\"\< \>\"", ",", "\"\<Hour\>\"", ",", "\"\<:\>\"", ",", 
           "\"\<Minute\>\""}], "}"}]}], "}"}], ",", "\"\<Year\>\""}], "]"}], "//",
      "ToExpression"}], "\[IndentingNewLine]", ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"month", "[", "t_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DateString", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"wData", "[", 
          RowBox[{"[", 
           RowBox[{"t", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Year\>\"", ",", "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", 
           "\"\< \>\"", ",", "\"\<Hour\>\"", ",", "\"\<:\>\"", ",", 
           "\"\<Minute\>\""}], "}"}]}], "}"}], ",", "\"\<Month\>\""}], "]"}], 
     "//", "ToExpression"}], "\[IndentingNewLine]", ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"day", "[", "t_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DateString", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"wData", "[", 
          RowBox[{"[", 
           RowBox[{"t", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Year\>\"", ",", "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", 
           "\"\< \>\"", ",", "\"\<Hour\>\"", ",", "\"\<:\>\"", ",", 
           "\"\<Minute\>\""}], "}"}]}], "}"}], ",", "\"\<Day\>\""}], "]"}], "//",
      "ToExpression"}], "\[IndentingNewLine]", ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dayOfWeek", "[", "t_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"DayOfWeek", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"year", "[", "t", "]"}], ",", 
        RowBox[{"month", "[", "t", "]"}], ",", 
        RowBox[{"day", "[", "t", "]"}]}], "}"}], "]"}], "\[IndentingNewLine]",
      ")"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Define", " ", "Price", " ", "of", " ", "buying", " ", "and", " ", 
    RowBox[{"selling", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BuyPrice", "[", "t_", "]"}], ":=", " ", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Saturday", ",", "Sunday"}], "}"}], ",", 
        RowBox[{"dayOfWeek", "[", "t", "]"}]}], "]"}], ",", "0.051", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"7", "\[LessEqual]", " ", 
          RowBox[{"Mod", "[", 
           RowBox[{"t", ",", "24"}], "]"}], "<", "11"}], "||", 
         RowBox[{"17", "<", 
          RowBox[{"Mod", "[", 
           RowBox[{"t", ",", "24"}], "]"}], "\[LessEqual]", " ", "21"}]}], 
        ",", "0.099", ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"11", "\[LessEqual]", 
           RowBox[{"Mod", "[", 
            RowBox[{"t", ",", "24"}], "]"}], "\[LessEqual]", " ", "17"}], ",",
           "0.081", ",", "\[IndentingNewLine]", "0.051"}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SellPrice", "[", "t_", "]"}], ":=", " ", 
    RowBox[{"0.8", "*", 
     RowBox[{"BuyPrice", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Initialize", " ", "stages"}], ",", " ", 
    RowBox[{"currently", " ", "two", " ", 
     RowBox[{"stages", "."}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stageSize", " ", "=", " ", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"availableResources", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", "stageSize"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"demand", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "stageSize"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Initial", " ", "values", " ", "to", " ", 
    RowBox[{"parameters", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"airDensity", " ", "=", " ", "1.27"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"windTurbineCoefficientFactor", " ", "=", " ", "0.5"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"windTurbineRadius", " ", "=", " ", "5"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solarRadiationFactor", " ", "=", " ", "1.2"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solarPanelSize", " ", "=", " ", "100"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initBatt", " ", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", "=", "15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"capBat", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Function", " ", "of", " ", "Available", " ", "Resources", " ", "at", " ", 
    "time", " ", 
    RowBox[{"t", ":", " ", 
     RowBox[{
     "electricity", " ", "power", " ", "from", " ", "wind", " ", "energy", 
      " ", "and", " ", "solar", " ", "energy"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AvailableResource", "[", "t_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"0.5", "*", "windTurbineCoefficientFactor", "*", 
       RowBox[{"windTurbineRadius", "^", "2"}], "*", "airDensity", "*", "Pi", 
       "*", 
       RowBox[{
        RowBox[{"windSpeed", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "^", "3"}]}], "+", 
      RowBox[{"solarRadiationFactor", "*", "solarPanelSize", "*", 
       RowBox[{"solarRadi", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"t", ",", "24"}], "]"}], "+", "1"}], ",", 
          RowBox[{"month", "[", "t", "]"}]}], "]"}], "]"}], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"cloudOvercastPercentage", "[", 
          RowBox[{"[", "t", "]"}], "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
     ")"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Function", " ", "of", " ", "Local", " ", "Demand", " ", "at", " ", "time",
     " ", 
    RowBox[{"t", ":", " ", 
     RowBox[{
     "pick", " ", "a", " ", "random", " ", "integer", " ", "from", " ", 
      "1000", " ", "to", " ", "10000"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Demand", "[", "t_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"t", "\[Equal]", "18"}], ",", "100000", ",", 
        RowBox[{
         RowBox[{"AvailableResource", "[", "t", "]"}], "+", "1000"}]}], "]"}],
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pLossRate", " ", "=", " ", "1000"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"heatDegreeHours", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "*", "pLossRate"}], "+", 
       RowBox[{
        RowBox[{"coolingDegreeHours", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "*", "pLossRate"}], "+", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"500", ",", "5000"}], "}"}], "]"}]}]}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{"1000", ",", "10000"}], "}"}], "]"}], "*)"}], 
     "\[IndentingNewLine]", ")"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Function", " ", "of", " ", "unit", " ", "cost", " ", "of", " ", 
    "reserving", " ", "electricity", " ", "in", " ", 
    RowBox[{"battery", " ", ":", " ", 
     RowBox[{"set", " ", "it", " ", "constant"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReserveCost", "[", "t_", "]"}], ":=", 
    RowBox[{"(", "0.002", ")"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Function", " ", "of", " ", "unit", " ", "cost", " ", "of", " ", 
    "transiting", " ", "electricity", " ", "to", " ", "or", " ", "from", " ", 
    RowBox[{"battery", " ", ":", " ", 
     RowBox[{"set", " ", "it", " ", "constant"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TransitionCost", "[", "t_", "]"}], ":=", 
    RowBox[{"(", "0.001", ")"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Function", " ", "of", " ", "optimization", " ", "of", " ", "simple", " ",
      "two"}], "-", "stage"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"B", "\[Rule]", 
     RowBox[{"C", ":", "1"}]}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"B", "\[Rule]", 
     RowBox[{"G", ":", "2"}]}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"G", "\[Rule]", 
     RowBox[{"B", ":", "3"}]}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"G", "\[Rule]", 
     RowBox[{"C", ":", "4"}]}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"R", "\[Rule]", 
     RowBox[{"B", ":", "5"}]}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"R", "\[Rule]", 
     RowBox[{"C", ":", "6"}]}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"R", "\[Rule]", 
     RowBox[{"G", ":", "7"}]}]}], "\[IndentingNewLine]", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StageMinimize", "[", 
    RowBox[{"t_", ",", "initBatt_"}], "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{"Minimize", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x", "[", "3", "]"}], "+", 
            RowBox[{"x", "[", "4", "]"}]}], ")"}], "*", 
          RowBox[{"BuyPrice", "[", "t", "]"}]}], "+", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"initBatt", "+", 
            RowBox[{"x", "[", "3", "]"}], "+", 
            RowBox[{"x", "[", "5", "]"}], "-", 
            RowBox[{"x", "[", "1", "]"}], "-", 
            RowBox[{"x", "[", "2", "]"}]}], ")"}], "*", 
          RowBox[{"ReserveCost", "[", "t", "]"}]}], " ", "+", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"initBatt", "+", 
            RowBox[{"x", "[", "3", "]"}], "+", 
            RowBox[{"x", "[", "5", "]"}], "+", 
            RowBox[{"x", "[", "1", "]"}], "+", 
            RowBox[{"x", "[", "2", "]"}]}], ")"}], "*", 
          RowBox[{"TransitionCost", "[", "t", "]"}]}], "-", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x", "[", "2", "]"}], "+", 
            RowBox[{"x", "[", "7", "]"}]}], ")"}], "*", 
          RowBox[{"SellPrice", "[", "t", "]"}]}], "+", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Stage", "[", 
           RowBox[{"t", "+", "2"}], "]"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"randomStateSequence", "[", 
              RowBox[{"[", "t", "]"}], "]"}], "\[Equal]", "\"\<N\>\""}], ",", 
            RowBox[{"threeMatrix", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"randomStateSequence", "[", 
                RowBox[{"[", "t", "]"}], "]"}], "\[Equal]", "\"\<A\>\""}], 
              ",", 
              RowBox[{"threeMatrix", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"threeMatrix", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}]}], "]"}], "*", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"4", ",", "1"}], "]"}]}], ")"}], "*", 
             RowBox[{"BuyPrice", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "1"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "1"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "1"}], "]"}]}], ")"}], "*", 
             RowBox[{"ReserveCost", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "1"}], "]"}]}], ")"}], "*", 
             RowBox[{"TransitionCost", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "-", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"7", ",", "1"}], "]"}]}], ")"}], "*", 
             RowBox[{"SellPrice", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"z", "[", 
                RowBox[{"3", ",", "1"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"4", ",", "1"}], "]"}]}], ")"}], "*", 
             RowBox[{"BuyPrice", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "1"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "1"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "1"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"3", ",", "1"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"5", ",", "1"}], "]"}], "-", 
               RowBox[{"z", "[", 
                RowBox[{"1", ",", "1"}], "]"}], "-", 
               RowBox[{"z", "[", 
                RowBox[{"2", ",", "1"}], "]"}]}], ")"}], "*", 
             RowBox[{"ReserveCost", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "1"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"3", ",", "1"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"5", ",", "1"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"1", ",", "1"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"2", ",", "1"}], "]"}]}], ")"}], "*", 
             RowBox[{"TransitionCost", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}], "-", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"z", "[", 
                RowBox[{"2", ",", "1"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"7", ",", "1"}], "]"}]}], ")"}], "*", 
             RowBox[{"SellPrice", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}]}], ")"}]}], "+", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"randomStateSequence", "[", 
              RowBox[{"[", "t", "]"}], "]"}], "\[Equal]", "\"\<N\>\""}], ",", 
            RowBox[{"threeMatrix", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"randomStateSequence", "[", 
                RowBox[{"[", "t", "]"}], "]"}], "\[Equal]", "\"\<A\>\""}], 
              ",", 
              RowBox[{"threeMatrix", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"threeMatrix", "[", 
               RowBox[{"3", ",", "2"}], "]"}]}], "]"}]}], "]"}], "*", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"4", ",", "2"}], "]"}]}], ")"}], "*", 
             RowBox[{"BuyPrice", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "2"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "2"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "2"}], "]"}]}], ")"}], "*", 
             RowBox[{"ReserveCost", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "  ", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "2"}], "]"}]}], ")"}], "*", 
             RowBox[{"TransitionCost", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "-", "\[IndentingNewLine]", 
            "\t\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"7", ",", "2"}], "]"}]}], ")"}], "*", 
             RowBox[{"SellPrice", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"z", "[", 
                RowBox[{"3", ",", "2"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"4", ",", "2"}], "]"}]}], ")"}], "*", 
             RowBox[{"BuyPrice", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "2"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "2"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "2"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"3", ",", "2"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"5", ",", "2"}], "]"}], "-", 
               RowBox[{"z", "[", 
                RowBox[{"1", ",", "2"}], "]"}], "-", 
               RowBox[{"z", "[", 
                RowBox[{"2", ",", "2"}], "]"}]}], ")"}], "*", 
             RowBox[{"ReserveCost", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}], "+", "  ", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "2"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"3", ",", "2"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"5", ",", "2"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"1", ",", "2"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"2", ",", "2"}], "]"}]}], ")"}], "*", 
             RowBox[{"TransitionCost", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}], "-", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"z", "[", 
                RowBox[{"2", ",", "2"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"7", ",", "2"}], "]"}]}], ")"}], "*", 
             RowBox[{"SellPrice", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}]}], ")"}]}], "+", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"randomStateSequence", "[", 
              RowBox[{"[", "t", "]"}], "]"}], "\[Equal]", "\"\<N\>\""}], ",", 
            RowBox[{"threeMatrix", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"randomStateSequence", "[", 
                RowBox[{"[", "t", "]"}], "]"}], "\[Equal]", "\"\<A\>\""}], 
              ",", 
              RowBox[{"threeMatrix", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "3"}], "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"threeMatrix", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "]"}]}], "]"}], "*", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"4", ",", "3"}], "]"}]}], ")"}], "*", 
             RowBox[{"BuyPrice", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "3"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "3"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "3"}], "]"}]}], ")"}], "*", 
             RowBox[{"ReserveCost", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "3"}], "]"}]}], ")"}], "*", 
             RowBox[{"TransitionCost", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "-", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"7", ",", "3"}], "]"}]}], ")"}], "*", 
             RowBox[{"SellPrice", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"z", "[", 
                RowBox[{"3", ",", "3"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"4", ",", "3"}], "]"}]}], ")"}], "*", 
             RowBox[{"BuyPrice", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "3"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "3"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "3"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"3", ",", "3"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"5", ",", "3"}], "]"}], "-", 
               RowBox[{"z", "[", 
                RowBox[{"1", ",", "3"}], "]"}], "-", 
               RowBox[{"z", "[", 
                RowBox[{"2", ",", "3"}], "]"}]}], ")"}], "*", 
             RowBox[{"ReserveCost", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "3"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"3", ",", "3"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"5", ",", "3"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"1", ",", "3"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"2", ",", "3"}], "]"}]}], ")"}], "*", 
             RowBox[{"TransitionCost", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}], "-", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"z", "[", 
                RowBox[{"2", ",", "3"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"7", ",", "3"}], "]"}]}], ")"}], "*", 
             RowBox[{"SellPrice", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}]}], ")"}]}], "+", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"randomStateSequence", "[", 
              RowBox[{"[", "t", "]"}], "]"}], "\[Equal]", "\"\<N\>\""}], ",", 
            RowBox[{"threeMatrix", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "4"}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"randomStateSequence", "[", 
                RowBox[{"[", "t", "]"}], "]"}], "\[Equal]", "\"\<A\>\""}], 
              ",", 
              RowBox[{"threeMatrix", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "4"}], "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"threeMatrix", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "4"}], "]"}], "]"}]}], "]"}]}], "]"}], "*", 
          RowBox[{"(", "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"4", ",", "1"}], "]"}]}], ")"}], "*", 
             RowBox[{"BuyPrice", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "1"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "1"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "1"}], "]"}]}], ")"}], "*", 
             RowBox[{"ReserveCost", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "1"}], "]"}]}], ")"}], "*", 
             RowBox[{"TransitionCost", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "-", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"7", ",", "1"}], "]"}]}], ")"}], "*", 
             RowBox[{"SellPrice", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"z", "[", 
                RowBox[{"3", ",", "4"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"4", ",", "4"}], "]"}]}], ")"}], "*", 
             RowBox[{"BuyPrice", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "1"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "1"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "1"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"3", ",", "4"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"5", ",", "4"}], "]"}], "-", 
               RowBox[{"z", "[", 
                RowBox[{"1", ",", "4"}], "]"}], "-", 
               RowBox[{"z", "[", 
                RowBox[{"2", ",", "4"}], "]"}]}], ")"}], "*", 
             RowBox[{"ReserveCost", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "1"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"3", ",", "4"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"5", ",", "4"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"1", ",", "4"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"2", ",", "4"}], "]"}]}], ")"}], "*", 
             RowBox[{"TransitionCost", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}], "-", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"z", "[", 
                RowBox[{"2", ",", "4"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"7", ",", "4"}], "]"}]}], ")"}], "*", 
             RowBox[{"SellPrice", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}]}], ")"}]}], "+", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"randomStateSequence", "[", 
              RowBox[{"[", "t", "]"}], "]"}], "\[Equal]", "\"\<N\>\""}], ",", 
            RowBox[{"threeMatrix", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "5"}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"randomStateSequence", "[", 
                RowBox[{"[", "t", "]"}], "]"}], "\[Equal]", "\"\<A\>\""}], 
              ",", 
              RowBox[{"threeMatrix", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "5"}], "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"threeMatrix", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "5"}], "]"}], "]"}]}], "]"}]}], "]"}], "*", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"4", ",", "2"}], "]"}]}], ")"}], "*", 
             RowBox[{"BuyPrice", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "2"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "2"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "2"}], "]"}]}], ")"}], "*", 
             RowBox[{"ReserveCost", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "  ", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "2"}], "]"}]}], ")"}], "*", 
             RowBox[{"TransitionCost", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "-", "\[IndentingNewLine]", 
            "\t\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"7", ",", "2"}], "]"}]}], ")"}], "*", 
             RowBox[{"SellPrice", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"z", "[", 
                RowBox[{"3", ",", "5"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"4", ",", "5"}], "]"}]}], ")"}], "*", 
             RowBox[{"BuyPrice", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "2"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "2"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "2"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"3", ",", "5"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"5", ",", "5"}], "]"}], "-", 
               RowBox[{"z", "[", 
                RowBox[{"1", ",", "5"}], "]"}], "-", 
               RowBox[{"z", "[", 
                RowBox[{"2", ",", "5"}], "]"}]}], ")"}], "*", 
             RowBox[{"ReserveCost", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "2"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"3", ",", "5"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"5", ",", "5"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"1", ",", "5"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"2", ",", "5"}], "]"}]}], ")"}], "*", 
             RowBox[{"TransitionCost", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}], "-", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"z", "[", 
                RowBox[{"2", ",", "5"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"7", ",", "5"}], "]"}]}], ")"}], "*", 
             RowBox[{"SellPrice", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}]}], ")"}]}], "+", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"randomStateSequence", "[", 
              RowBox[{"[", "t", "]"}], "]"}], "\[Equal]", "\"\<N\>\""}], ",", 
            RowBox[{"threeMatrix", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "6"}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"randomStateSequence", "[", 
                RowBox[{"[", "t", "]"}], "]"}], "\[Equal]", "\"\<A\>\""}], 
              ",", 
              RowBox[{"threeMatrix", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "6"}], "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"threeMatrix", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "6"}], "]"}], "]"}]}], "]"}]}], "]"}], "*", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"4", ",", "3"}], "]"}]}], ")"}], "*", 
             RowBox[{"BuyPrice", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "3"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "3"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "3"}], "]"}]}], ")"}], "*", 
             RowBox[{"ReserveCost", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "3"}], "]"}]}], ")"}], "*", 
             RowBox[{"TransitionCost", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "-", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"7", ",", "3"}], "]"}]}], ")"}], "*", 
             RowBox[{"SellPrice", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"z", "[", 
                RowBox[{"3", ",", "6"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"4", ",", "6"}], "]"}]}], ")"}], "*", 
             RowBox[{"BuyPrice", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "3"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "3"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "3"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"3", ",", "6"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"5", ",", "6"}], "]"}], "-", 
               RowBox[{"z", "[", 
                RowBox[{"1", ",", "6"}], "]"}], "-", 
               RowBox[{"z", "[", 
                RowBox[{"2", ",", "6"}], "]"}]}], ")"}], "*", 
             RowBox[{"ReserveCost", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "3"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"3", ",", "6"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"5", ",", "6"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"1", ",", "6"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"2", ",", "6"}], "]"}]}], ")"}], "*", 
             RowBox[{"TransitionCost", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}], "-", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"z", "[", 
                RowBox[{"2", ",", "6"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"7", ",", "6"}], "]"}]}], ")"}], "*", 
             RowBox[{"SellPrice", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}]}], ")"}]}], "+", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"randomStateSequence", "[", 
              RowBox[{"[", "t", "]"}], "]"}], "\[Equal]", "\"\<N\>\""}], ",", 
            RowBox[{"threeMatrix", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "7"}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"randomStateSequence", "[", 
                RowBox[{"[", "t", "]"}], "]"}], "\[Equal]", "\"\<A\>\""}], 
              ",", 
              RowBox[{"threeMatrix", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "7"}], "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"threeMatrix", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "7"}], "]"}], "]"}]}], "]"}]}], "]"}], "*", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"4", ",", "1"}], "]"}]}], ")"}], "*", 
             RowBox[{"BuyPrice", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "1"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "1"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "1"}], "]"}]}], ")"}], "*", 
             RowBox[{"ReserveCost", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "1"}], "]"}]}], ")"}], "*", 
             RowBox[{"TransitionCost", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "-", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"7", ",", "1"}], "]"}]}], ")"}], "*", 
             RowBox[{"SellPrice", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"z", "[", 
                RowBox[{"3", ",", "7"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"4", ",", "7"}], "]"}]}], ")"}], "*", 
             RowBox[{"BuyPrice", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "1"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "1"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "1"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"3", ",", "7"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"5", ",", "7"}], "]"}], "-", 
               RowBox[{"z", "[", 
                RowBox[{"1", ",", "7"}], "]"}], "-", 
               RowBox[{"z", "[", 
                RowBox[{"2", ",", "7"}], "]"}]}], ")"}], "*", 
             RowBox[{"ReserveCost", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "1"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "1"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"3", ",", "7"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"5", ",", "7"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"1", ",", "7"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"2", ",", "7"}], "]"}]}], ")"}], "*", 
             RowBox[{"TransitionCost", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}], "-", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"z", "[", 
                RowBox[{"2", ",", "7"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"7", ",", "7"}], "]"}]}], ")"}], "*", 
             RowBox[{"SellPrice", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}]}], ")"}]}], "+", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"randomStateSequence", "[", 
              RowBox[{"[", "t", "]"}], "]"}], "\[Equal]", "\"\<N\>\""}], ",", 
            RowBox[{"threeMatrix", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "8"}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"randomStateSequence", "[", 
                RowBox[{"[", "t", "]"}], "]"}], "\[Equal]", "\"\<A\>\""}], 
              ",", 
              RowBox[{"threeMatrix", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "8"}], "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"threeMatrix", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "8"}], "]"}], "]"}]}], "]"}]}], "]"}], "*", 
          RowBox[{"(", "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"4", ",", "2"}], "]"}]}], ")"}], "*", 
             RowBox[{"BuyPrice", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "2"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "2"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "2"}], "]"}]}], ")"}], "*", 
             RowBox[{"ReserveCost", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "  ", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "2"}], "]"}]}], ")"}], "*", 
             RowBox[{"TransitionCost", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "-", "\[IndentingNewLine]", 
            "\t\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"7", ",", "2"}], "]"}]}], ")"}], "*", 
             RowBox[{"SellPrice", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"z", "[", 
                RowBox[{"3", ",", "8"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"4", ",", "8"}], "]"}]}], ")"}], "*", 
             RowBox[{"BuyPrice", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "2"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "2"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "2"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"3", ",", "8"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"5", ",", "8"}], "]"}], "-", 
               RowBox[{"z", "[", 
                RowBox[{"1", ",", "8"}], "]"}], "-", 
               RowBox[{"z", "[", 
                RowBox[{"2", ",", "8"}], "]"}]}], ")"}], "*", 
             RowBox[{"ReserveCost", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "2"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "2"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"3", ",", "8"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"5", ",", "8"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"1", ",", "8"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"2", ",", "8"}], "]"}]}], ")"}], "*", 
             RowBox[{"TransitionCost", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}], "-", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"z", "[", 
                RowBox[{"2", ",", "8"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"7", ",", "8"}], "]"}]}], ")"}], "*", 
             RowBox[{"SellPrice", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}]}], ")"}]}], "+", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"randomStateSequence", "[", 
              RowBox[{"[", "t", "]"}], "]"}], "\[Equal]", "\"\<N\>\""}], ",", 
            RowBox[{"threeMatrix", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "9"}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"randomStateSequence", "[", 
                RowBox[{"[", "t", "]"}], "]"}], "\[Equal]", "\"\<A\>\""}], 
              ",", 
              RowBox[{"threeMatrix", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "9"}], "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"threeMatrix", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "9"}], "]"}], "]"}]}], "]"}]}], "]"}], "*", 
          RowBox[{"(", "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"4", ",", "3"}], "]"}]}], ")"}], "*", 
             RowBox[{"BuyPrice", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "3"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "3"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "3"}], "]"}]}], ")"}], "*", 
             RowBox[{"ReserveCost", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "3"}], "]"}]}], ")"}], "*", 
             RowBox[{"TransitionCost", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "-", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"7", ",", "3"}], "]"}]}], ")"}], "*", 
             RowBox[{"SellPrice", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"z", "[", 
                RowBox[{"3", ",", "9"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"4", ",", "9"}], "]"}]}], ")"}], "*", 
             RowBox[{"BuyPrice", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "3"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "3"}], "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "3"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"3", ",", "9"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"5", ",", "9"}], "]"}], "-", 
               RowBox[{"z", "[", 
                RowBox[{"1", ",", "9"}], "]"}], "-", 
               RowBox[{"z", "[", 
                RowBox[{"2", ",", "9"}], "]"}]}], ")"}], "*", 
             RowBox[{"ReserveCost", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}], "+", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initBatt", "+", 
                 RowBox[{"x", "[", "3", "]"}], "+", 
                 RowBox[{"x", "[", "5", "]"}], "-", 
                 RowBox[{"x", "[", "1", "]"}], "-", 
                 RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"3", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"5", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"1", ",", "3"}], "]"}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"2", ",", "3"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"3", ",", "9"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"5", ",", "9"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"1", ",", "9"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"2", ",", "9"}], "]"}]}], ")"}], "*", 
             RowBox[{"TransitionCost", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}], "-", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"z", "[", 
                RowBox[{"2", ",", "9"}], "]"}], "+", 
               RowBox[{"z", "[", 
                RowBox[{"7", ",", "9"}], "]"}]}], ")"}], "*", 
             RowBox[{"SellPrice", "[", 
              RowBox[{"t", "+", "2"}], "]"}]}]}], ")"}]}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "1", "]"}], "+", 
           RowBox[{"x", "[", "4", "]"}], "+", 
           RowBox[{"x", "[", "6", "]"}]}], "\[Equal]", 
          RowBox[{"Demand", "[", "t", "]"}]}], "&&", "\[IndentingNewLine]", 
         RowBox[{"0", "\[LessEqual]", " ", 
          RowBox[{"initBatt", "+", 
           RowBox[{"x", "[", "5", "]"}], "+", 
           RowBox[{"x", "[", "3", "]"}], "-", 
           RowBox[{"x", "[", "2", "]"}], "-", 
           RowBox[{"x", "[", "1", "]"}]}], "\[LessEqual]", " ", "capBat"}], "&&",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "7", "]"}], "+", 
           RowBox[{"x", "[", "5", "]"}], "+", 
           RowBox[{"x", "[", "6", "]"}]}], "\[Equal]", 
          RowBox[{"AvailableResource", "[", "t", "]"}]}], "&&", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"x", "[", "3", "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"x", "[", "4", "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"x", "[", "5", "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"x", "[", "6", "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"x", "[", "7", "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"x", "[", "1", "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"x", "[", "2", "]"}], "\[GreaterEqual]", "0"}], "&&", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"stage", "[", 
           RowBox[{"t", "+", "1"}], "]"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"1", ",", "1"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"4", ",", "1"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"6", ",", "1"}], "]"}]}], "\[Equal]", 
          RowBox[{"Demand", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "&&", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"initBatt", "+", 
             RowBox[{"x", "[", "3", "]"}], "+", 
             RowBox[{"x", "[", "5", "]"}], "-", 
             RowBox[{"x", "[", "1", "]"}], "-", 
             RowBox[{"x", "[", "2", "]"}]}], ")"}]}], "\[LessEqual]", " ", 
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"5", ",", "1"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"3", ",", "1"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"2", ",", "1"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"1", ",", "1"}], "]"}]}], "\[LessEqual]", " ", 
          RowBox[{"capBat", "-", 
           RowBox[{"(", 
            RowBox[{"initBatt", "+", 
             RowBox[{"x", "[", "3", "]"}], "+", 
             RowBox[{"x", "[", "5", "]"}], "-", 
             RowBox[{"x", "[", "1", "]"}], "-", 
             RowBox[{"x", "[", "2", "]"}]}], ")"}]}]}], "&&", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"7", ",", "1"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"5", ",", "1"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"6", ",", "1"}], "]"}]}], "\[Equal]", 
          RowBox[{"AvailableResource", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "&&", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"3", ",", "1"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"4", ",", "1"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"5", ",", "1"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"6", ",", "1"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"7", ",", "1"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"1", ",", "1"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"2", ",", "1"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"1", ",", "2"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"4", ",", "2"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"6", ",", "2"}], "]"}]}], "\[Equal]", 
          RowBox[{"Demand", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "&&", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"initBatt", "+", 
             RowBox[{"x", "[", "3", "]"}], "+", 
             RowBox[{"x", "[", "5", "]"}], "-", 
             RowBox[{"x", "[", "1", "]"}], "-", 
             RowBox[{"x", "[", "2", "]"}]}], ")"}]}], "\[LessEqual]", " ", 
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"5", ",", "2"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"3", ",", "2"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"2", ",", "2"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"1", ",", "2"}], "]"}]}], "\[LessEqual]", " ", 
          RowBox[{"capBat", "-", 
           RowBox[{"(", 
            RowBox[{"initBatt", "+", 
             RowBox[{"x", "[", "3", "]"}], "+", 
             RowBox[{"x", "[", "5", "]"}], "-", 
             RowBox[{"x", "[", "1", "]"}], "-", 
             RowBox[{"x", "[", "2", "]"}]}], ")"}]}]}], "&&", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"7", ",", "2"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"5", ",", "2"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"6", ",", "2"}], "]"}]}], "\[Equal]", 
          RowBox[{
           RowBox[{"AvailableResource", "[", 
            RowBox[{"t", "+", "1"}], "]"}], "/", "2"}]}], "&&", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"3", ",", "2"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"4", ",", "2"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"5", ",", "2"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"6", ",", "2"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"7", ",", "2"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"1", ",", "2"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"2", ",", "2"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"1", ",", "3"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"4", ",", "3"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"6", ",", "3"}], "]"}]}], "\[Equal]", 
          RowBox[{"Demand", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "&&", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"initBatt", "+", 
             RowBox[{"x", "[", "3", "]"}], "+", 
             RowBox[{"x", "[", "5", "]"}], "-", 
             RowBox[{"x", "[", "1", "]"}], "-", 
             RowBox[{"x", "[", "2", "]"}]}], ")"}]}], "\[LessEqual]", " ", 
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"5", ",", "3"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"3", ",", "3"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"2", ",", "3"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"1", ",", "3"}], "]"}]}], "\[LessEqual]", " ", 
          RowBox[{"capBat", "-", 
           RowBox[{"(", 
            RowBox[{"initBatt", "+", 
             RowBox[{"x", "[", "3", "]"}], "+", 
             RowBox[{"x", "[", "5", "]"}], "-", 
             RowBox[{"x", "[", "1", "]"}], "-", 
             RowBox[{"x", "[", "2", "]"}]}], ")"}]}]}], "&&", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"7", ",", "3"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"5", ",", "3"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"6", ",", "3"}], "]"}]}], "\[Equal]", 
          RowBox[{
           RowBox[{"AvailableResource", "[", 
            RowBox[{"t", "+", "1"}], "]"}], "/", "4"}]}], "&&", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"3", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"4", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"5", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"6", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"7", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"1", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"2", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"state", "[", 
           RowBox[{"t", "+", "2"}], "]"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "[", 
            RowBox[{"1", ",", "1"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"4", ",", "1"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"6", ",", "1"}], "]"}]}], "\[Equal]", 
          RowBox[{"Demand", "[", 
           RowBox[{"t", "+", "2"}], "]"}]}], "&&", "\[IndentingNewLine]", 
         RowBox[{"0", "\[LessEqual]", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"initBatt", "+", 
             RowBox[{"x", "[", "3", "]"}], "+", 
             RowBox[{"x", "[", "5", "]"}], "-", 
             RowBox[{"x", "[", "1", "]"}], "-", 
             RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"5", ",", "1"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"3", ",", "1"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"2", ",", "1"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"1", ",", "1"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"5", ",", "1"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"3", ",", "1"}], "]"}], "-", 
           RowBox[{"z", "[", 
            RowBox[{"2", ",", "1"}], "]"}], "-", 
           RowBox[{"z", "[", 
            RowBox[{"1", ",", "1"}], "]"}]}], "\[LessEqual]", " ", "capBat"}],
          "&&", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "[", 
            RowBox[{"7", ",", "1"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"5", ",", "1"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"6", ",", "1"}], "]"}]}], "\[Equal]", 
          RowBox[{"AvailableResource", "[", 
           RowBox[{"t", "+", "2"}], "]"}]}], "&&", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "[", 
            RowBox[{"1", ",", "2"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"4", ",", "2"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"6", ",", "2"}], "]"}]}], "\[Equal]", 
          RowBox[{"Demand", "[", 
           RowBox[{"t", "+", "2"}], "]"}]}], "&&", "\[IndentingNewLine]", 
         RowBox[{"0", "\[LessEqual]", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"initBatt", "+", 
             RowBox[{"x", "[", "3", "]"}], "+", 
             RowBox[{"x", "[", "5", "]"}], "-", 
             RowBox[{"x", "[", "1", "]"}], "-", 
             RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"5", ",", "1"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"3", ",", "1"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"2", ",", "1"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"1", ",", "1"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"5", ",", "2"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"3", ",", "2"}], "]"}], "-", 
           RowBox[{"z", "[", 
            RowBox[{"2", ",", "2"}], "]"}], "-", 
           RowBox[{"z", "[", 
            RowBox[{"1", ",", "2"}], "]"}]}], "\[LessEqual]", " ", "capBat"}],
          "&&", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "[", 
            RowBox[{"7", ",", "2"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"5", ",", "2"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"6", ",", "2"}], "]"}]}], "\[Equal]", 
          RowBox[{
           RowBox[{"AvailableResource", "[", 
            RowBox[{"t", "+", "2"}], "]"}], "/", "2"}]}], "&&", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "[", 
            RowBox[{"1", ",", "3"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"4", ",", "3"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"6", ",", "3"}], "]"}]}], "\[Equal]", 
          RowBox[{"Demand", "[", 
           RowBox[{"t", "+", "2"}], "]"}]}], "&&", "\[IndentingNewLine]", 
         RowBox[{"0", "\[LessEqual]", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"initBatt", "+", 
             RowBox[{"x", "[", "3", "]"}], "+", 
             RowBox[{"x", "[", "5", "]"}], "-", 
             RowBox[{"x", "[", "1", "]"}], "-", 
             RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"5", ",", "1"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"3", ",", "1"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"2", ",", "1"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"1", ",", "1"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"5", ",", "3"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"3", ",", "3"}], "]"}], "-", 
           RowBox[{"z", "[", 
            RowBox[{"2", ",", "3"}], "]"}], "-", 
           RowBox[{"z", "[", 
            RowBox[{"1", ",", "3"}], "]"}]}], "\[LessEqual]", " ", "capBat"}],
          "&&", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "[", 
            RowBox[{"7", ",", "3"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"5", ",", "3"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"6", ",", "3"}], "]"}]}], "\[Equal]", 
          RowBox[{
           RowBox[{"AvailableResource", "[", 
            RowBox[{"t", "+", "2"}], "]"}], "/", "4"}]}], "&&", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "[", 
            RowBox[{"1", ",", "4"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"4", ",", "4"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"6", ",", "4"}], "]"}]}], "\[Equal]", 
          RowBox[{"Demand", "[", 
           RowBox[{"t", "+", "2"}], "]"}]}], "&&", "\[IndentingNewLine]", 
         RowBox[{"0", "\[LessEqual]", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"initBatt", "+", 
             RowBox[{"x", "[", "3", "]"}], "+", 
             RowBox[{"x", "[", "5", "]"}], "-", 
             RowBox[{"x", "[", "1", "]"}], "-", 
             RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"5", ",", "1"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"3", ",", "1"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"2", ",", "1"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"1", ",", "1"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"5", ",", "4"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"3", ",", "4"}], "]"}], "-", 
           RowBox[{"z", "[", 
            RowBox[{"2", ",", "4"}], "]"}], "-", 
           RowBox[{"z", "[", 
            RowBox[{"1", ",", "4"}], "]"}]}], "\[LessEqual]", " ", "capBat"}],
          "&&", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "[", 
            RowBox[{"7", ",", "4"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"5", ",", "4"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"6", ",", "4"}], "]"}]}], "\[Equal]", 
          RowBox[{"AvailableResource", "[", 
           RowBox[{"t", "+", "2"}], "]"}]}], "&&", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "[", 
            RowBox[{"1", ",", "5"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"4", ",", "5"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"6", ",", "5"}], "]"}]}], "\[Equal]", 
          RowBox[{"Demand", "[", 
           RowBox[{"t", "+", "2"}], "]"}]}], "&&", "\[IndentingNewLine]", 
         RowBox[{"0", "\[LessEqual]", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"initBatt", "+", 
             RowBox[{"x", "[", "3", "]"}], "+", 
             RowBox[{"x", "[", "5", "]"}], "-", 
             RowBox[{"x", "[", "1", "]"}], "-", 
             RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"5", ",", "1"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"3", ",", "1"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"2", ",", "1"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"1", ",", "1"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"5", ",", "5"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"3", ",", "5"}], "]"}], "-", 
           RowBox[{"z", "[", 
            RowBox[{"2", ",", "5"}], "]"}], "-", 
           RowBox[{"z", "[", 
            RowBox[{"1", ",", "5"}], "]"}]}], "\[LessEqual]", " ", "capBat"}],
          "&&", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "[", 
            RowBox[{"7", ",", "5"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"5", ",", "5"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"6", ",", "5"}], "]"}]}], "\[Equal]", 
          RowBox[{
           RowBox[{"AvailableResource", "[", 
            RowBox[{"t", "+", "2"}], "]"}], "/", "2"}]}], "&&", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "[", 
            RowBox[{"1", ",", "6"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"4", ",", "6"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"6", ",", "6"}], "]"}]}], "\[Equal]", 
          RowBox[{"Demand", "[", 
           RowBox[{"t", "+", "2"}], "]"}]}], "&&", "\[IndentingNewLine]", 
         RowBox[{"0", "\[LessEqual]", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"initBatt", "+", 
             RowBox[{"x", "[", "3", "]"}], "+", 
             RowBox[{"x", "[", "5", "]"}], "-", 
             RowBox[{"x", "[", "1", "]"}], "-", 
             RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"5", ",", "1"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"3", ",", "1"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"2", ",", "1"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"1", ",", "1"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"5", ",", "6"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"3", ",", "6"}], "]"}], "-", 
           RowBox[{"z", "[", 
            RowBox[{"2", ",", "6"}], "]"}], "-", 
           RowBox[{"z", "[", 
            RowBox[{"1", ",", "6"}], "]"}]}], "\[LessEqual]", " ", "capBat"}],
          "&&", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "[", 
            RowBox[{"7", ",", "6"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"5", ",", "6"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"6", ",", "6"}], "]"}]}], "\[Equal]", 
          RowBox[{
           RowBox[{"AvailableResource", "[", 
            RowBox[{"t", "+", "2"}], "]"}], "/", "4"}]}], "&&", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "[", 
            RowBox[{"1", ",", "7"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"4", ",", "7"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"6", ",", "7"}], "]"}]}], "\[Equal]", 
          RowBox[{"Demand", "[", 
           RowBox[{"t", "+", "2"}], "]"}]}], "&&", "\[IndentingNewLine]", 
         RowBox[{"0", "\[LessEqual]", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"initBatt", "+", 
             RowBox[{"x", "[", "3", "]"}], "+", 
             RowBox[{"x", "[", "5", "]"}], "-", 
             RowBox[{"x", "[", "1", "]"}], "-", 
             RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"5", ",", "1"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"3", ",", "1"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"2", ",", "1"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"1", ",", "1"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"5", ",", "7"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"3", ",", "7"}], "]"}], "-", 
           RowBox[{"z", "[", 
            RowBox[{"2", ",", "7"}], "]"}], "-", 
           RowBox[{"z", "[", 
            RowBox[{"1", ",", "7"}], "]"}]}], "\[LessEqual]", " ", "capBat"}],
          "&&", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "[", 
            RowBox[{"7", ",", "7"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"5", ",", "7"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"6", ",", "7"}], "]"}]}], "\[Equal]", 
          RowBox[{"AvailableResource", "[", 
           RowBox[{"t", "+", "2"}], "]"}]}], "&&", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "[", 
            RowBox[{"1", ",", "8"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"4", ",", "8"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"6", ",", "8"}], "]"}]}], "\[Equal]", 
          RowBox[{"Demand", "[", 
           RowBox[{"t", "+", "2"}], "]"}]}], "&&", "\[IndentingNewLine]", 
         RowBox[{"0", "\[LessEqual]", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"initBatt", "+", 
             RowBox[{"x", "[", "3", "]"}], "+", 
             RowBox[{"x", "[", "5", "]"}], "-", 
             RowBox[{"x", "[", "1", "]"}], "-", 
             RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"5", ",", "1"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"3", ",", "1"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"2", ",", "1"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"1", ",", "1"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"5", ",", "8"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"3", ",", "8"}], "]"}], "-", 
           RowBox[{"z", "[", 
            RowBox[{"2", ",", "8"}], "]"}], "-", 
           RowBox[{"z", "[", 
            RowBox[{"1", ",", "8"}], "]"}]}], "\[LessEqual]", " ", "capBat"}],
          "&&", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "[", 
            RowBox[{"7", ",", "8"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"5", ",", "8"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"6", ",", "8"}], "]"}]}], "\[Equal]", 
          RowBox[{
           RowBox[{"AvailableResource", "[", 
            RowBox[{"t", "+", "2"}], "]"}], "/", "2"}]}], "&&", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "[", 
            RowBox[{"1", ",", "9"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"4", ",", "9"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"6", ",", "9"}], "]"}]}], "\[Equal]", 
          RowBox[{"Demand", "[", 
           RowBox[{"t", "+", "2"}], "]"}]}], "&&", "\[IndentingNewLine]", 
         RowBox[{"0", "\[LessEqual]", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"initBatt", "+", 
             RowBox[{"x", "[", "3", "]"}], "+", 
             RowBox[{"x", "[", "5", "]"}], "-", 
             RowBox[{"x", "[", "1", "]"}], "-", 
             RowBox[{"x", "[", "2", "]"}]}], ")"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"5", ",", "1"}], "]"}], "+", 
           RowBox[{"y", "[", 
            RowBox[{"3", ",", "1"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"2", ",", "1"}], "]"}], "-", 
           RowBox[{"y", "[", 
            RowBox[{"1", ",", "1"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"5", ",", "9"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"3", ",", "9"}], "]"}], "-", 
           RowBox[{"z", "[", 
            RowBox[{"2", ",", "9"}], "]"}], "-", 
           RowBox[{"z", "[", 
            RowBox[{"1", ",", "9"}], "]"}]}], "\[LessEqual]", " ", "capBat"}],
          "&&", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "[", 
            RowBox[{"7", ",", "9"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"5", ",", "9"}], "]"}], "+", 
           RowBox[{"z", "[", 
            RowBox[{"6", ",", "9"}], "]"}]}], "\[Equal]", 
          RowBox[{
           RowBox[{"AvailableResource", "[", 
            RowBox[{"t", "+", "2"}], "]"}], "/", "4"}]}], 
         "\[IndentingNewLine]", "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"1", ",", "1"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"1", ",", "2"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"1", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"1", ",", "4"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"1", ",", "5"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"1", ",", "6"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"1", ",", "7"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"1", ",", "8"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"1", ",", "9"}], "]"}], "\[GreaterEqual]", "0"}], 
         "\[IndentingNewLine]", "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"2", ",", "1"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"2", ",", "2"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"2", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"2", ",", "4"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"2", ",", "5"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"2", ",", "6"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"2", ",", "7"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"2", ",", "8"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"2", ",", "9"}], "]"}], "\[GreaterEqual]", "0"}], 
         "\[IndentingNewLine]", "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"3", ",", "1"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"3", ",", "2"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"3", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"3", ",", "4"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"3", ",", "5"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"3", ",", "6"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"3", ",", "7"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"3", ",", "8"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"3", ",", "9"}], "]"}], "\[GreaterEqual]", "0"}], 
         "\[IndentingNewLine]", "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"4", ",", "1"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"4", ",", "2"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"4", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"4", ",", "4"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"4", ",", "5"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"4", ",", "6"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"4", ",", "7"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"4", ",", "8"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"4", ",", "9"}], "]"}], "\[GreaterEqual]", "0"}], 
         "\[IndentingNewLine]", "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"5", ",", "1"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"5", ",", "2"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"5", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"5", ",", "4"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"5", ",", "5"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"5", ",", "6"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"5", ",", "7"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"5", ",", "8"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"5", ",", "9"}], "]"}], "\[GreaterEqual]", "0"}], 
         "\[IndentingNewLine]", "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"6", ",", "1"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"6", ",", "2"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"6", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"6", ",", "4"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"6", ",", "5"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"6", ",", "6"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"6", ",", "7"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"6", ",", "8"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"6", ",", "9"}], "]"}], "\[GreaterEqual]", "0"}], 
         "\[IndentingNewLine]", "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"7", ",", "1"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"7", ",", "2"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"7", ",", "3"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"7", ",", "4"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"7", ",", "5"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"7", ",", "6"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"7", ",", "7"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"7", ",", "8"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"7", ",", "9"}], "]"}], "\[GreaterEqual]", "0"}]}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", "[", "3", "]"}], ",", 
        RowBox[{"x", "[", "4", "]"}], ",", 
        RowBox[{"x", "[", "5", "]"}], ",", 
        RowBox[{"x", "[", "6", "]"}], ",", 
        RowBox[{"x", "[", "7", "]"}], ",", 
        RowBox[{"x", "[", "1", "]"}], ",", 
        RowBox[{"x", "[", "2", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"y", "[", 
         RowBox[{"3", ",", "1"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"4", ",", "1"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"5", ",", "1"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"6", ",", "1"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"7", ",", "1"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"1", ",", "1"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"2", ",", "1"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"3", ",", "2"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"4", ",", "2"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"5", ",", "2"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"6", ",", "2"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"7", ",", "2"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"2", ",", "2"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"3", ",", "3"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"4", ",", "3"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"5", ",", "3"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"6", ",", "3"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"7", ",", "3"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"1", ",", "3"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"2", ",", "3"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"z", "[", 
         RowBox[{"1", ",", "1"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"2", ",", "1"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"3", ",", "1"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"4", ",", "1"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"5", ",", "1"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"6", ",", "1"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"7", ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"z", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"2", ",", "2"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"3", ",", "2"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"4", ",", "2"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"5", ",", "2"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"6", ",", "2"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"7", ",", "2"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"z", "[", 
         RowBox[{"1", ",", "3"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"2", ",", "3"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"3", ",", "3"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"4", ",", "3"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"5", ",", "3"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"6", ",", "3"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"7", ",", "3"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"z", "[", 
         RowBox[{"1", ",", "4"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"2", ",", "4"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"3", ",", "4"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"4", ",", "4"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"5", ",", "4"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"6", ",", "4"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"7", ",", "4"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"z", "[", 
         RowBox[{"1", ",", "5"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"2", ",", "5"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"3", ",", "5"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"4", ",", "5"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"5", ",", "5"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"6", ",", "5"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"7", ",", "5"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"z", "[", 
         RowBox[{"1", ",", "6"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"2", ",", "6"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"3", ",", "6"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"4", ",", "6"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"5", ",", "6"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"6", ",", "6"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"7", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"z", "[", 
         RowBox[{"1", ",", "7"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"2", ",", "7"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"3", ",", "7"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"4", ",", "7"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"5", ",", "7"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"6", ",", "7"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"7", ",", "7"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"z", "[", 
         RowBox[{"1", ",", "8"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"2", ",", "8"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"3", ",", "8"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"4", ",", "8"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"5", ",", "8"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"6", ",", "8"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"7", ",", "8"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"z", "[", 
         RowBox[{"1", ",", "9"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"2", ",", "9"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"3", ",", "9"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"4", ",", "9"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"5", ",", "9"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"6", ",", "9"}], "]"}], ",", 
        RowBox[{"z", "[", 
         RowBox[{"7", ",", "9"}], "]"}]}], "}"}]}], "]"}], 
    "\[IndentingNewLine]", ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.605836587559079*^9, 3.6058367443860493`*^9}, {
   3.605836794787932*^9, 3.605836801242301*^9}, {3.6058388236359754`*^9, 
   3.605838907337763*^9}, {3.605838953701415*^9, 3.6058389827700777`*^9}, {
   3.6058390333779716`*^9, 3.605839129606476*^9}, {3.6058392562687206`*^9, 
   3.605839352604231*^9}, {3.605873501104938*^9, 3.6058735536149416`*^9}, {
   3.60587367230373*^9, 3.605873800488062*^9}, {3.6058740350464773`*^9, 
   3.6058741114808493`*^9}, {3.605874146135832*^9, 3.6058741931135187`*^9}, {
   3.605874850330109*^9, 3.605874885753135*^9}, {3.605875005300973*^9, 
   3.6058751958088694`*^9}, {3.605875379709388*^9, 3.60587539250412*^9}, {
   3.6058756161869135`*^9, 3.605875714453534*^9}, {3.6058757649434223`*^9, 
   3.605875870907483*^9}, {3.605875922304423*^9, 3.6058760108214855`*^9}, {
   3.605876041413235*^9, 3.6058760415052404`*^9}, {3.605876077826318*^9, 
   3.6058762208304977`*^9}, {3.605876598903122*^9, 3.605876619428296*^9}, {
   3.6058818078305883`*^9, 3.6058818569706745`*^9}, {3.6058851048747063`*^9, 
   3.605885165379167*^9}, {3.605885204200388*^9, 3.6058856966215525`*^9}, {
   3.605885841902862*^9, 3.605885886185395*^9}, 3.60588598033578*^9, {
   3.6058889595400705`*^9, 3.6058889624572754`*^9}, 3.6058890750582733`*^9, {
   3.605890072270564*^9, 3.6058900975520105`*^9}, {3.605898868220422*^9, 
   3.6058988683452225`*^9}, {3.6058989278749266`*^9, 3.605898929949731*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.6058946376526895`*^9, 3.605894645599144*^9}},
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"firstStep", " ", "=", " ", 
  RowBox[{"StageMinimize", "[", 
   RowBox[{"21", ",", "100"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6058988734932313`*^9, 3.6058989133045015`*^9}, {
   3.6058989611809855`*^9, 3.605898962054587*^9}, {3.6064887243005304`*^9, 
   3.6064887244365387`*^9}, 3.606491135662177*^9, {3.6064912318156767`*^9, 
   3.6064912322977047`*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"9354.17824032626`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "[", "3", "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"x", "[", "4", "]"}], "\[Rule]", "35904.63580511304`"}], ",", 
     RowBox[{
      RowBox[{"x", "[", "5", "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"x", "[", "6", "]"}], "\[Rule]", "2806.364194886962`"}], ",", 
     RowBox[{
      RowBox[{"x", "[", "7", "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"x", "[", "1", "]"}], "\[Rule]", "100.`"}], ",", 
     RowBox[{
      RowBox[{"x", "[", "2", "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"3", ",", "1"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"4", ",", "1"}], "]"}], "\[Rule]", "38157.95721487112`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"5", ",", "1"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"6", ",", "1"}], "]"}], "\[Rule]", "2885.042785128876`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"7", ",", "1"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"1", ",", "1"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"3", ",", "2"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"4", ",", "2"}], "]"}], "\[Rule]", "40302.478607435565`"}], 
     ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"5", ",", "2"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"6", ",", "2"}], "]"}], "\[Rule]", "1442.521392564438`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"7", ",", "2"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"2", ",", "2"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"3", ",", "3"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"4", ",", "3"}], "]"}], "\[Rule]", "39855.73930371778`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"5", ",", "3"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"6", ",", "3"}], "]"}], "\[Rule]", "721.260696282219`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"7", ",", "3"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"1", ",", "3"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"2", ",", "3"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"1", ",", "1"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"3", ",", "1"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"4", ",", "1"}], "]"}], "\[Rule]", "36942.870792374044`"}], 
     ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"5", ",", "1"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"6", ",", "1"}], "]"}], "\[Rule]", "2729.129207625957`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"7", ",", "1"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"2", ",", "2"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"3", ",", "2"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"4", ",", "2"}], "]"}], "\[Rule]", "39072.43539618702`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"5", ",", "2"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"6", ",", "2"}], "]"}], "\[Rule]", "1364.5646038129785`"}], 
     ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"7", ",", "2"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"1", ",", "3"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"2", ",", "3"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"3", ",", "3"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"4", ",", "3"}], "]"}], "\[Rule]", "41917.71769809351`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"5", ",", "3"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"6", ",", "3"}], "]"}], "\[Rule]", "682.2823019064892`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"7", ",", "3"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"1", ",", "4"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"2", ",", "4"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"3", ",", "4"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"4", ",", "4"}], "]"}], "\[Rule]", "38173.870792374044`"}], 
     ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"5", ",", "4"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"6", ",", "4"}], "]"}], "\[Rule]", "2729.129207625957`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"7", ",", "4"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"1", ",", "5"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"2", ",", "5"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"3", ",", "5"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"4", ",", "5"}], "]"}], "\[Rule]", "40606.43539618702`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"5", ",", "5"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"6", ",", "5"}], "]"}], "\[Rule]", "1364.5646038129785`"}], 
     ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"7", ",", "5"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"1", ",", "6"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"2", ",", "6"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"3", ",", "6"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"4", ",", "6"}], "]"}], "\[Rule]", "41452.71769809351`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"5", ",", "6"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"6", ",", "6"}], "]"}], "\[Rule]", "682.2823019064892`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"7", ",", "6"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"1", ",", "7"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"2", ",", "7"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"3", ",", "7"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"4", ",", "7"}], "]"}], "\[Rule]", "39712.870792374044`"}], 
     ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"5", ",", "7"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"6", ",", "7"}], "]"}], "\[Rule]", "2729.129207625957`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"7", ",", "7"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"1", ",", "8"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"2", ",", "8"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"3", ",", "8"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"4", ",", "8"}], "]"}], "\[Rule]", "38821.43539618702`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"5", ",", "8"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"6", ",", "8"}], "]"}], "\[Rule]", "1364.5646038129785`"}], 
     ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"7", ",", "8"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"1", ",", "9"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"2", ",", "9"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"3", ",", "9"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"4", ",", "9"}], "]"}], "\[Rule]", "42291.71769809351`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"5", ",", "9"}], "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"6", ",", "9"}], "]"}], "\[Rule]", "682.2823019064892`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"7", ",", "9"}], "]"}], "\[Rule]", "0.`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.60589888389845*^9, 3.6058989627409883`*^9}, 
   3.6064881034758935`*^9, 3.6064887250485735`*^9, 3.6064911379783096`*^9},
 FontSize->14]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cost", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bat", " ", "=", " ", 
   RowBox[{"{", "initBatt", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"t", "=", "1"}], ",", " ", 
   RowBox[{"t", "<", "50"}], ",", 
   RowBox[{"t", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"firstStep", " ", "=", " ", 
     RowBox[{"StageMinimize", "[", 
      RowBox[{"t", ",", " ", "initBatt"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"cost", " ", "=", " ", 
     RowBox[{"Append", "[", 
      RowBox[{"cost", ",", 
       RowBox[{"firstStep", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"initBatt", " ", "=", " ", 
     RowBox[{"initBatt", " ", "+", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x", "[", "3", "]"}], "/.", 
        RowBox[{"firstStep", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x", "[", "5", "]"}], "/.", 
        RowBox[{"firstStep", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x", "[", "1", "]"}], "/.", 
        RowBox[{"firstStep", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x", "[", "2", "]"}], "/.", 
        RowBox[{"firstStep", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"bat", " ", "=", " ", 
     RowBox[{"Append", "[", 
      RowBox[{"bat", ",", "initBatt"}], "]"}]}]}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"secondStep", " ", "=", " ", 
     RowBox[{"StageMinimize", "[", 
      RowBox[{
       RowBox[{"t", "+", "1"}], ",", "initBatt"}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.6064882378292494`*^9, 3.6064883292987733`*^9}, {
   3.606488391302251*^9, 3.6064884047733603`*^9}, {3.606488438280978*^9, 
   3.6064884923058643`*^9}, {3.6064885649075775`*^9, 
   3.6064885944031105`*^9}, {3.60649144954113*^9, 3.6064914504951844`*^9}, 
   3.6064915479397583`*^9, {3.6064916080761976`*^9, 3.6064916083352127`*^9}},
 FontSize->14],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.6064916243991313`*^9},
 FontSize->14]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"bat", ",", 
   RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6064885797702847`*^9, 3.606488585433095*^9}, {
  3.606488688680274*^9, 3.6064886894003153`*^9}, {3.606490161050432*^9, 
  3.6064901628205338`*^9}, {3.606490272741821*^9, 3.6064902920579257`*^9}},
 FontSize->14],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.24720000000000014`, 0.24, 0.6], 
    LineBox[{{1., 0.}, {2., 0.}, {3., 0.}, {4., 0.}, {5., 0.}, {6., 0.}, {7., 
     1000.0000000000005`}, {8., 3.637978807091713*^-12}, {9., 
     3.637978807091713*^-12}, {10., 0.}, {11., 0.}, {12., 0.}}]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  Method->{},
  PlotRange->{{0, 12.}, {0, 9.094947017729282*^-12}},
  PlotRangeClipping->True,
  PlotRangePadding->{{0.24, 0.24}, {1.8189894035458566`*^-13, 
   1.8189894035458566`*^-13}}]], "Output",
 CellChangeTimes->{
  3.6064885870554976`*^9, {3.6064886649049144`*^9, 3.6064886897713366`*^9}, 
   3.6064901638465924`*^9, {3.6064902749919496`*^9, 3.606490292527952*^9}, 
   3.606491444179823*^9, 3.6064915204451857`*^9, 3.606491551681972*^9, 
   3.6064916281233444`*^9},
 FontSize->14]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["bat"], "Input",
 CellChangeTimes->{{3.6064903112680244`*^9, 3.6064903152922544`*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "1000.0000000000005`", ",", "3.637978807091713`*^-12", ",", 
   "3.637978807091713`*^-12", ",", "0.`", ",", "0.`", ",", "0.`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.606490315638274*^9, 3.6064915551391697`*^9, 
  3.606491632893617*^9},
 FontSize->14]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["bat"], "Input",
 CellChangeTimes->{{3.606491531328808*^9, 3.6064915322898626`*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", "0.`", ",", "0.`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{3.6064915330999093`*^9},
 FontSize->14]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1272, 704},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 164, 3, 68, "Section"],
Cell[746, 27, 42174, 1026, 2712, "Input"],
Cell[CellGroupData[{
Cell[42945, 1057, 154, 4, 31, "Input"],
Cell[43102, 1063, 3189, 89, 77, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[46340, 1158, 118, 2, 68, "Section"],
Cell[46461, 1162, 36313, 937, 2372, "Input"],
Cell[82777, 2101, 216, 5, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83030, 2111, 121, 2, 68, "Section"],
Cell[83154, 2115, 121169, 2969, 5812, "Input"],
Cell[204326, 5086, 159, 3, 31, "Input"],
Cell[CellGroupData[{
Cell[204510, 5093, 401, 8, 31, "Input"],
Cell[204914, 5103, 9987, 281, 231, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[214938, 5389, 2318, 60, 192, "Input"],
Cell[217259, 5451, 94, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[217390, 5458, 357, 7, 31, "Input"],
Cell[217750, 5467, 906, 20, 223, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[218693, 5492, 114, 2, 31, "Input"],
Cell[218810, 5496, 373, 9, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[219220, 5510, 112, 2, 31, "Input"],
Cell[219335, 5514, 160, 4, 32, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
